(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"45mF":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var a=i("1YZw"),s=i("pXBW"),n=i("3XMw"),o=i.n(n),r=i("SrIh");const l=o.a.a5d4fda0,c=(e=l,t=!0)=>({customErrorHandler:i=>{const{context:n}=i;return!i instanceof s.a&&(i.message=`Strato error occurred in ${n.id}: ${n.action}`),Object(r.a)(i,{extra:{context:n,isStrato:!0}}),t?Object(a.b)({text:e}):[]}})},"6XNv":function(e,t,i){"use strict";var a=i("KEM+"),s=i.n(a),n=(i("kYxP"),i("ERkP")),o=i("t62R"),r=i("piX5"),l=i("4r2z"),c=i("FG+G"),d=i("rHpw"),h=(i("aWzz"),i("k/Ka")),u=i("shC7"),p=i("MWbm");const m=n.forwardRef(((e,t)=>Object(h.a)("select",{...e,ref:t}))),g=e=>Object(h.a)("option",e);let _=1;class y extends n.PureComponent{constructor(e){super(e),s()(this,"_selectRef",n.createRef()),s()(this,"state",{isFocused:!1}),s()(this,"_handleChange",(e=>{const{onChange:t,withEmptyOption:i}=this.props,{selectedIndex:a,value:s}=e.target;t&&t(s,a-(i?1:0))})),s()(this,"_handleBlur",(e=>{const{onBlur:t}=this.props;this.setState({isFocused:!1}),t&&t()})),s()(this,"_handleFocus",(e=>{const{onFocus:t}=this.props;this.setState({isFocused:!0}),t&&t()})),this._id=`SELECTOR_${_}`,this._errorID=`${this._id}_ERROR`,this._helperID=`${this._id}_HELP`,this._labelID=`${this._id}_LABEL`,_+=1}componentDidMount(){this.props.autofocus&&this._selectRef&&this._selectRef.current&&this._selectRef.current.focus()}render(){const{accessibilityDescribedBy:e,style:t,disabled:i,options:a,value:s,hasError:h,errorText:_,helperText:y,testID:f,withEmptyOption:C}=this.props,{isFocused:w}=this.state,v=o.c.getLanguage(),T="ja"===v?d.a.theme.fontFamilies.japan:u.a.getConstants().isRTL||l.a.isLocaleRTL(v)?d.a.theme.fontFamilies.rtl:d.a.theme.fontFamilies.normal,x=void 0===h?!!_:h,E=new Set;_&&E.add(this._errorID),e&&E.add(e),y&&E.add(this._helperID);const S=E.size?[...E].join(" "):void 0;return n.createElement(n.Fragment,null,n.createElement(p.a,{style:[r.a.border,b.container,i&&r.a.disabled,w&&r.a.focusedBorderValid,x&&r.a.invalidBorderColor,w&&x&&r.a.focusedBorderInvalid,t]},this._renderLabel(),n.createElement(m,{accessibilityDescribedBy:S,accessibilityInvalid:x,accessibilityLabelledBy:this._labelID,disabled:i,nativeID:this._id,onBlur:this._handleBlur,onChange:this._handleChange,onFocus:this._handleFocus,ref:this._selectRef,style:[b.select,{fontFamily:T},i&&r.a.disabled],testID:f||"",value:s},C?n.createElement(g,{disabled:!0,style:b.option,value:""}):null,a.map((e=>{const{disabled:t,label:i,value:a}=e;return n.createElement(g,{disabled:t,key:`${i}-${a}`,style:b.option,value:a},i)}))),n.createElement(c.a,{style:[b.dropdownCaret,w&&r.a.validColor,(h||_)&&r.a.invalidColor]})),y?this._renderHelperText():null,x&&_?this._renderErrorText():null)}_renderLabel(){const{errorText:e,hasError:t,label:i}=this.props,{isFocused:a}=this.state;return n.createElement(o.c,{accessibilityRole:"label",color:t||e?"red500":a?"primary":"gray700",nativeID:this._labelID,style:b.label},i)}_renderHelperText(){return n.createElement(p.a,{accessibilityLiveRegion:"polite"},n.createElement(o.c,{color:"gray700",nativeID:this._helperID,style:b.helperText},this.props.helperText))}_renderErrorText(){return n.createElement(p.a,{accessibilityLiveRegion:"polite"},n.createElement(o.c,{color:"red500",nativeID:this._errorID,style:b.helperText},this.props.errorText))}}s()(y,"defaultProps",{disabled:!1,autofocus:!1,withEmptyOption:!1}),y.propTypes={};const b=d.a.create((e=>({container:{backgroundColor:e.colors.cellBackground},dropdownCaret:{color:e.colors.gray700,height:"1.5em",pointerEvents:"none",position:"absolute",marginTop:"-0.75em",top:"50%",right:e.spaces.space12},label:{position:"absolute",fontSize:e.fontSizes.subtext2,paddingHorizontal:e.spaces.space8,paddingTop:e.spaces.space8,pointerEvents:"none",lineHeight:e.lineHeights.subtext2},option:{backgroundColor:e.colors.navigationBackground},select:{appearance:"none",backgroundColor:"transparent",borderRadius:e.borderRadii.none,borderWidth:e.borderWidths.none,color:e.colors.text,cursor:"pointer",fontSize:e.fontSizes.headline2,lineHeight:e.lineHeights.headline2,margin:0,marginTop:e.spaces.space16,outlineStyle:"none",padding:0,paddingTop:e.spaces.space12,paddingBottom:e.spaces.space8,paddingHorizontal:e.spaces.space8},helperText:{fontSize:e.fontSizes.subtext2,paddingHorizontal:e.spaces.space8,paddingTop:e.spaces.space2}})));t.a=y},"8A5z":function(e,t,i){"use strict";var a=i("ERkP"),s=i("Lsrn"),n=i("k/Ka");const o=(e={})=>Object(n.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[s.a.root,e.style],viewBox:"0 0 24 24"},a.createElement("g",null,a.createElement("path",{d:"M9.008 15.205c-1.766 0-3.187-1.35-3.187-3.196v-.02c0-1.8 1.388-3.214 3.26-3.214 1.26 0 2.075.53 2.62 1.29L10.494 11c-.306-.42-.798-.695-1.357-.695-.93 0-1.684.754-1.684 1.684s.755 1.684 1.685 1.684c.578 0 1.087-.292 1.39-.735l1.22.87c-.583.802-1.368 1.394-2.737 1.394h-.002zm6.582 0c-1.764 0-3.185-1.35-3.185-3.196v-.02c0-1.8 1.386-3.214 3.258-3.214 1.262 0 2.075.53 2.622 1.29l-1.21.935c-.305-.42-.797-.694-1.356-.694-.93 0-1.685.754-1.685 1.684s.754 1.685 1.684 1.685c.577 0 1.086-.292 1.39-.735l1.22.87c-.584.803-1.37 1.395-2.738 1.395z"}),a.createElement("path",{d:"M20.5 2.02h-17c-1.24 0-2.25 1.007-2.25 2.247v15.507c0 1.238 1.01 2.246 2.25 2.246h17c1.24 0 2.25-1.008 2.25-2.246V4.267c0-1.24-1.01-2.247-2.25-2.247zm.75 17.754c0 .41-.336.746-.75.746h-17c-.414 0-.75-.336-.75-.746V4.267c0-.412.336-.747.75-.747h17c.414 0 .75.335.75.747v15.507z"})));o.metadata={width:24,height:24},t.a=o},MXY2:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var a=i("3XMw"),s=i.n(a);const n=s.a.g34f2c63,o=s.a.f70a36d0,r=s.a.d17df547,l=s.a.h735a98d,c=e=>{const t=e.inReplyToStatus&&!e.isSelfThreadReply;return e.isScheduled?l:t?r:e.isThread?o:n({verb:""})}},Ub51:function(e,t,i){"use strict";var a=i("97Jx"),s=i.n(a),n=i("KEM+"),o=i.n(n),r=(i("MvUL"),i("Qavd"),i("kYxP"),i("ERkP")),l=i("6/RC"),c=i("wpu3"),d=i("ZNx0"),h=i("xZGM"),u=i("eSoz"),p=i("rxPX"),m=i("0KEI"),g=i("o3oN");const _=(e,t)=>{const i=t.selectedCommunityId;return i?u.a.select(e,i):void 0},y=(e,t)=>Object(h.q)(e,h.e);var b=Object(p.a)().propsFromState((()=>({communities:u.b,selectedCommunity:_,fetchStatus:g.c,educationalVisibilityFlag:y}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(m.d)("COMMUNITIES_CONTROLS"),fetchCommunityMemberships:g.a,addEducationFlag:()=>Object(h.o)(h.e)}))),f=i("kGix"),C=i("3XMw"),w=i.n(C),v=i("FG+G"),T=i("YeIG"),x=i("Zg3A"),E=i("MWbm"),S=i("MtXG"),I=i("t62R"),R=i("CKsB"),A=i("rHpw");const k=w.a.e815fc33,M=w.a.c63602d3,B=w.a.baffe39a,D=w.a.d58baa7e;class N extends r.Component{constructor(...e){super(...e),o()(this,"_renderCount",(e=>{const t=D(e);return r.createElement(S.a.Group,null,r.createElement(S.a,null,r.createElement(I.c,{color:"white"},r.createElement(w.a.I18NFormatMessage,{$i18n:"b38e130b"},r.createElement(S.a.Value,null,w.a.ibd0106d({formattedCount:t})),r.createElement(S.a.Label,null,w.a.cface2d0({count:e}))))))})),o()(this,"_createClickHandler",(e=>()=>{const{onCommunityValueChange:t,dismiss:i}=this.props;t(e),i()}))}render(){const{communities:e,selectedCommunityId:t}=this.props;return r.createElement(E.a,{style:O.root},r.createElement(d.a,{viewType:"everyone"},r.createElement(E.a,null,r.createElement(I.c,{size:"headline1",style:O.title,weight:"bold"},k),r.createElement(R.a,{Icon:x.a,actionText:B,isSelected:!!t,onClick:this._createClickHandler(void 0),style:O.menuItem,withIconAsThumbnail:!0}))),r.createElement(E.a,null,r.createElement(d.a,{viewType:"community"},r.createElement(I.c,{style:O.title,weight:"bold"},M),Object.keys(e).map((i=>{const a=e[i];return a?r.createElement(R.a,{actionSubText:this._renderCount(a.member_count),actionText:a.name,isSelected:t===i,key:i,media:a.media,onClick:this._createClickHandler(i),selectable:!0,style:O.menuItem}):null})))))}}const O=A.a.create((e=>({hidden:{visibility:"hidden"},title:{flexDirection:"column",paddingVertical:e.spaces.space4,paddingHorizontal:e.spaces.space12},root:{flexDirection:"column",paddingTop:e.spaces.space12,paddingBottom:e.spaces.space12},menuItem:{alignItems:"center"}})));var L=N,F=i("efqG"),P=i("/yvb");const H=w.a.baffe39a,V=r.createElement(v.a,null);class z extends r.Component{constructor(...e){super(...e),o()(this,"_renderContent",(e=>{const{communities:t,selectedCommunityId:i}=this.props;return r.createElement(L,{communities:t,dismiss:e,onCommunityValueChange:this._handleCommunityValueChange,selectedCommunityId:i})})),o()(this,"_handleCommunityValueChange",(e=>{this._handleDismissEducationalVisibilty(),this.props.onCommunityValueChange(e)})),o()(this,"_handleDismissEducationalVisibilty",(()=>{this.props.addEducationFlag()}))}componentDidMount(){const{fetchCommunityMemberships:e,fetchStatus:t,createLocalApiErrorHandler:i}=this.props;t===f.a.NONE&&e().catch(i())}render(){const{communities:e,selectedCommunity:t,educationalVisibilityFlag:i}=this.props,a=i&&!t;return Object(T.a)(e)?null:r.createElement(d.a,{viewType:"communities_controls"},r.createElement(E.a,{style:[j.container]},r.createElement(F.a,{onDismiss:this._handleDismissEducationalVisibilty,renderContent:this._renderContent,visibilityBehavior:a?"forceVisible":"interactive"},r.createElement(P.a,{icon:V,size:"small",type:"secondary"},t?t.name:H))))}}const j=A.a.create((e=>({button:{paddingHorizontal:e.spaces.space4},container:{display:"inline-flex",flexDirection:"row",paddingBottom:e.spaces.space12},hidden:{visibility:"hidden"},root:{flexDirection:"column",paddingTop:e.spaces.space16,paddingBottom:e.spaces.space16}})));var U=b(z),W=i("PKbs");const $=(e,t)=>{const i=t.selectedCommunityId;return i?u.a.select(e,i):void 0};var K=Object(p.a)().propsFromState((()=>({community:$}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(m.d)("COMMUNITY_RULES"),fetchCommunityIfNeeded:u.a.fetchOneIfNeeded}))),G=i("21zW");const q=w.a.gfca5254,X=w.a.f510c8b2;class Y extends r.Component{constructor(...e){super(...e),o()(this,"_renderContent",(e=>{const{community:t}=this.props;if(null!=t&&t.rules){const{rules:e}=t;return r.createElement(W.a,{badgeStyle:Q.badgeStyle,headerContainerStyle:Q.rulesHeader,heading:this._renderRulesHeading(),ruleContainerStyle:Q.ruleContainerStyle,rules:e})}return null})),o()(this,"_renderRulesHeading",(()=>r.createElement(I.c,{weight:"bold"},X)))}componentDidMount(){const{fetchCommunityIfNeeded:e,selectedCommunityId:t,createLocalApiErrorHandler:i}=this.props;e(t).catch(i())}render(){const{community:e,showMiddot:t}=this.props;return null!=e&&e.rules&&e.rules.length>0?r.createElement(E.a,{style:Q.container},t?r.createElement(G.a,null):null,r.createElement(F.a,{renderContent:this._renderContent},r.createElement(P.a,{size:"small",style:[Q.button,!t&&Q.buttonWithoutMiddot],type:"text"},q))):null}}const Q=A.a.create((e=>({badgeStyle:{marginRight:e.spaces.space12},container:{display:"inline-flex",flexDirection:"row",paddingBottom:e.spaces.space12,alignItems:"baseline"},rulesHeader:{marginHorizontal:e.spaces.space16,marginVertical:e.spaces.space12},ruleContainerStyle:{paddingHorizontal:e.spaces.space16,fontWeight:"normal"},button:{paddingLeft:e.spaces.space8,paddingRight:e.spaces.space8},buttonWithoutMiddot:{marginLeft:`calc(-1 * ${e.spaces.space8})`}})));var Z=K(Y);const J=(e,t)=>Object(h.q)(e,h.f);var ee=Object(p.a)().propsFromState((()=>({shouldShowEducation:J}))).propsFromActions((()=>({addEducationFlag:()=>Object(h.o)(h.f)}))),te=i("4zmP");const ie=w.a.g46f363d,ae={viewType:"community_rule_education"};const se=A.a.create((e=>({container:{marginBottom:e.spaces.space8}})));var ne=ee((function({shouldShowEducation:e,addEducationFlag:t}){const i=()=>{t()};return r.useEffect((()=>i)),e?r.createElement(E.a,{style:se.container},r.createElement(te.a,{clientEventContext:ae,onClose:i,text:ie,withCloseButton:!0})):null})),oe=i("H7Rt"),re=i("yZqq"),le=i("Irs7"),ce=i("DlMI"),de=i("gBde"),he=i("gUPl"),ue=i("cOhU");const pe=r.createElement(ce.a,null),me=r.createElement(de.a,null),ge=r.createElement(he.a,null),_e=r.createElement(ue.a,null),ye="conversation_control",be=Object.freeze({all:{icon:pe,label:w.a.i8ea6d4e},community:{icon:ge,label:w.a.ec5a4a25},by_invitation:{icon:me,label:w.a.b4543009},community_members:{icon:_e,label:w.a.i13be5a0}});Object.freeze(["community","by_invitation"]);var fe=Object(le.a)((e=>{const{analytics:t,...i}=e,{disabled:a,value:s}=e,{icon:n,label:o}=be[s],l=r.useCallback((e=>{t.scribe({element:ye,action:"click"})}),[t]);return r.createElement(d.a,{viewType:ye},r.createElement(E.a,{style:Ce.container},r.createElement(re.a,i,r.createElement(P.a,{disabled:a,icon:n,onPress:l,pullLeft:!0,size:"small",style:Ce.button,type:"text"},o))))}));const Ce=A.a.create((e=>({button:{paddingLeft:`calc(${e.spaces.space8} + ${e.spaces.space2})`,paddingRight:`calc(${e.spaces.space8} + ${e.spaces.space2})`},container:{display:"inline-flex",flexDirection:"row",paddingBottom:e.spaces.space12}})));var we=i("krmn"),ve=i("SrCX"),Te=i("cIoY"),xe=i("w3n3"),Ee=i("MLl7"),Se=i("1auM"),Ie=i("07FG"),Re=i("Q8CU"),Ae=i("QbaN"),ke=i("VPdC"),Me=i("oQhu"),Be=i("p+r5"),De=i("GWvE");class Ne extends r.Component{constructor(...e){super(...e),o()(this,"_setInputRef",(e=>{this._inputRef=e}))}render(){const{autoFocus:e,defaultValue:t,editable:i,label:a,onChange:s,name:n}=this.props;return r.createElement(E.a,{style:Oe.root},r.createElement(Be.a,{autoCapitalize:"none",autoCorrect:!1,autoFocus:e,defaultValue:t,editable:i,label:a,maxLength:25,name:n,onChange:s,ref:this._setInputRef,spellCheck:"false",style:Oe.formTextInput}))}get value(){return this._inputRef&&this._inputRef.getValue()}get isValid(){const{optional:e}=this.props;return!this.value&&e||this.value&&!Object(De.a)(this.value)&&this._inputRef&&this._inputRef.isValidLength()}}o()(Ne,"defaultProps",{autoFocus:!1,editable:!0,optional:!1});const Oe=A.a.create((e=>({root:{flexDirection:"row",flexShrink:1},action:{width:e.spaces.space40},addButton:{flexGrow:1,minHeight:"100%",padding:0},formTextInput:{flexGrow:1,flexShrink:1,marginVertical:0,paddingTop:0,paddingHorizontal:0,paddingBottom:e.spaces.space12}})));var Le=Ne,Fe=i("mtvn"),Pe=i("6XNv");class He extends r.PureComponent{render(){const{editable:e,label:t,last:i,max:a,min:s,onChange:n,value:o}=this.props,l=!e||s===a,c=o.toString(),d=Object(Fe.a)(s,a+1).map((e=>({label:`${w.a.ia24dc8c(e)}`,value:`${e}`})));return r.createElement(Pe.a,{disabled:l,label:t,onChange:n,options:d,style:[Ve.selector,!i&&Ve.rightMargin],value:c})}}o()(He,"defaultProps",{last:!1});const Ve=A.a.create((e=>({rightMargin:{marginRight:e.spaces.space20},selector:{flexGrow:1}})));var ze=He;const je=w.a.caf8edc4,Ue=w.a.g93586be,We=w.a.d073b644,$e=w.a.a2f0728e;class Ke extends r.Component{constructor(e,t){super(e,t),o()(this,"_handleDaysChange",(e=>{const t=parseInt(e,10);this.setState((e=>{const{hours:i,minutes:a}=e.duration,s=0===t&&0===i&&0===a?1:7===t?0:i;return{duration:{days:t,hours:s,minutes:7===t?0:0===t&&0===s&&a<5?5:a}}}))})),o()(this,"_handleHoursChange",(e=>{const t=parseInt(e,10);this.setState((e=>{const{days:i,minutes:a}=e.duration;return{duration:{days:i,hours:t,minutes:0===i&&0===t&&a<5?5:a}}}))})),o()(this,"_handleMinutesChange",(e=>{const t=parseInt(e,10);this.setState((e=>{const{days:i,hours:a}=e.duration;return{duration:{days:i,hours:a,minutes:t}}}))})),this.state={duration:e.initialDuration}}render(){const{style:e,isActive:t}=this.props;return r.createElement(E.a,{style:e},r.createElement(I.c,{color:"normal",style:Ge.durationLabel},t?je:""),this._renderPicker())}_renderPicker(){const{editable:e,isActive:t}=this.props,{duration:{days:i,hours:a,minutes:s}}=this.state;return r.createElement(E.a,{style:Ge.durationControls},r.createElement(ze,{editable:e&&t,label:Ue,max:7,min:0,onChange:this._handleDaysChange,value:i}),r.createElement(ze,{editable:e&&t,label:We,max:7===i?0:23,min:0,onChange:this._handleHoursChange,value:a}),r.createElement(ze,{editable:e&&t,label:$e,last:!0,max:7===i?0:59,min:0===i&&0===a?5:0,onChange:this._handleMinutesChange,value:s}))}get duration(){return this.state.duration}}o()(Ke,"defaultProps",{editable:!0,initialDuration:{days:1,hours:0,minutes:0}});const Ge=A.a.create((e=>({durationControls:{flexDirection:"row",justifyContent:"space-between"},durationLabel:{marginBottom:e.spaces.space4}})));var qe=Ke,Xe=i("iY63"),Ye=i("jtO7");const Qe=w.a.g589c2e1,Ze=w.a.a1e6c3a1,Je=w.a.a739e006,et=w.a.d89a5b92,tt=w.a.c2a8118d,it=w.a.a8ede1de,at=w.a.af40a8ef;class st extends r.Component{constructor(e,t){super(e,t),o()(this,"_setChoice1Ref",(e=>{this._choice1=e})),o()(this,"_setChoice2Ref",(e=>{this._choice2=e})),o()(this,"_setChoice3Ref",(e=>{this._choice3=e})),o()(this,"_setChoice4Ref",(e=>{this._choice4=e})),o()(this,"_setDurationPickerRef",(e=>{this._durationPicker=e})),o()(this,"_handleValidation",(()=>{const{onValid:e,onInvalid:t}=this.props,i=this.choices,{_choice1:a,_choice2:s,_choice3:n,_choice4:o}=this,r=[a,s,n,o].filter(Boolean).every((e=>e.isValid));i&&i.length>=2&&r?e():t()})),o()(this,"_handleAdd",(()=>{const{analytics:e}=this.props;e.scribe({element:"add_poll_option",action:"click"}),this.setState((({choiceCount:e})=>({autoFocus:!0,choiceCount:e+1})))}));const{initialChoices:i}=e,a=void 0===i,s=(i||[]).length,n=s>2?s:2;this.state={autoFocus:a,choiceCount:n}}_renderChoices(){const{editable:e,initialChoices:t=[],isActive:i}=this.props,{autoFocus:a,choiceCount:s}=this.state,n=r.createElement(E.a,{style:nt.rightColumn},s<4?r.createElement(P.a,{accessibilityLabel:it,disabled:!(e&&i),hoverLabel:{label:at},icon:r.createElement(Xe.a,null),onPress:this._handleAdd,size:"normal",style:nt.addButton,type:"text"}):null);return r.createElement(E.a,{style:nt.choicesAndAddButton},r.createElement(E.a,{style:nt.choices},r.createElement(Le,{autoFocus:a,defaultValue:t[0],editable:e&&i,label:Qe,name:"Choice1",onChange:this._handleValidation,ref:this._setChoice1Ref}),r.createElement(Le,{defaultValue:t[1],editable:e&&i,label:Ze,name:"Choice2",onChange:this._handleValidation,ref:this._setChoice2Ref}),s>=3?r.createElement(Le,{autoFocus:a,defaultValue:t[2],editable:e&&i,label:Je,name:"Choice3",onChange:this._handleValidation,optional:!0,ref:this._setChoice3Ref}):null,4===s?r.createElement(Le,{autoFocus:a,defaultValue:t[3],editable:e&&i,label:et,name:"Choice4",onChange:this._handleValidation,optional:!0,ref:this._setChoice4Ref}):null),n)}render(){const{editable:e,initialDuration:t,isActive:i,onRemove:a}=this.props;return r.createElement(E.a,{style:nt.root},this._renderChoices(),r.createElement(qe,{editable:e,initialDuration:t,isActive:i,ref:this._setDurationPickerRef,style:nt.durationPicker}),r.createElement(E.a,{style:nt.removePollButton},r.createElement(Ye.a,{color:"red500",label:tt,onPress:a,withBottomBorder:!1})))}get choices(){const{_choice1:e,_choice2:t,_choice3:i,_choice4:a}=this;return[e&&e.value,t&&t.value,i&&i.value,a&&a.value].filter(Boolean)}get duration(){return this._durationPicker?this._durationPicker.duration:void 0}}const nt=A.a.create((e=>({root:{backgroundColor:e.colors.transparent,borderColor:e.colors.nestedBorderColor,borderRadius:e.borderRadii.xLarge,borderStyle:"solid",borderWidth:e.borderWidths.small,flexDirection:"column",overflow:"hidden",paddingTop:e.spaces.space12},choicesAndAddButton:{paddingHorizontal:e.spaces.space12,flexDirection:"row"},choices:{flexGrow:1,flexShrink:1},removePollButton:{borderBottomLeftRadius:e.borderRadii.xLarge,borderBottomRightRadius:e.borderRadii.xLarge},rightColumn:{flexDirection:"column-reverse"},addButton:{marginBottom:e.spaces.space24,marginLeft:e.spaces.space4},durationPicker:{borderTopColor:e.colors.nestedBorderColor,borderTopWidth:e.borderWidths.small,borderBottomColor:e.colors.nestedBorderColor,borderBottomWidth:e.borderWidths.small,padding:e.spaces.space12}})));var ot=Object(le.a)(st);const rt=A.a.create((e=>({container:{marginBottom:e.spaces.space4},link:{color:"black"}}))),lt=w.a.i859676b,ct=r.createElement(w.a.I18NFormatMessage,{$i18n:"a02c8d74"},r.createElement(I.c,{link:"/settings/audience_and_tagging",style:rt.link,withInteractiveStyling:!0,withUnderline:!0},w.a.c9a48d3f));function dt(){return r.createElement(E.a,{style:rt.container},r.createElement(te.a,{headline:lt,text:ct,withInlineAction:!0}))}var ht=i("b5s6"),ut=i("rcen"),pt=i("zmS9"),mt=i("WPfJ");var gt=A.a.create((e=>({root:{paddingHorizontal:e.componentDimensions.gutterHorizontal},avatarContainerExpanded:{paddingTop:e.spaces.space4},avatarContainer:{justifyContent:"center"},avatar:{width:"100%"},controlsContainer:{borderBottomColor:e.colors.borderColor,borderBottomWidth:e.spaces.space1,width:"100%"},mobileControlsLayout:{flexDirection:"column"},controlsLayout:{flexDirection:"row",alignItems:"center"},rightColumn:{paddingTop:e.spaces.space4,justifyContent:"center",position:"static",transitionProperty:"opacity, color",transitionDuration:"0.1s",transitionTimingFunction:"ease-out"},composeBoxContainer:{display:"flex",flexDirection:"column",flexGrow:1,flexShrink:1,position:"static",zIndex:1},inputArea:{zIndex:1},dragDrop:{borderColor:e.colors.transparent,borderRadius:e.borderRadii.small,borderStyle:"solid",borderWidth:e.borderWidths.medium},textInputArea:{alignItems:"center",flexDirection:"row",justifyContent:"space-between",zIndex:mt.f},textInputStyle:{paddingHorizontal:0},textInputMobileCollapsed:{maxHeight:e.fontSizes.title4,padding:0,overflow:"hidden"},tweetAttachmentArea:{zIndex:mt.e},iconEmojiPicker:{zIndex:mt.c},toolBar:{alignItems:"center",backgroundColor:e.colors.cellBackground,flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",marginHorizontal:e.spaces.space2,zIndex:mt.a},firstToolBarButton:{marginLeft:`calc(-1 * (${e.spaces.space8} + ${e.spaces.space2}))`},toolBarButton:{marginHorizontal:0},toolBarIconsContainer:{alignItems:"center",flexDirection:"row",marginTop:e.spaces.space12},separator:{width:"1px",backgroundColor:e.colors.gray300,height:e.fontSizes.title2,marginRight:e.spaces.space12,marginLeft:`calc(${e.spaces.space12} - 2px)`},conversationLine:{alignSelf:"center",backgroundColor:e.colors.gray200,flexGrow:1,flexShrink:1,minHeight:0,width:e.componentDimensions.conversationLineWidth,marginTop:e.spaces.space4,marginBottom:e.spaces.space4},conversationLineWithOverflow:{marginTop:`-${e.spaces.space4}`},attachmentContainer:{marginTop:e.spaces.space4,marginBottom:e.spaces.space4},mediaPreview:{marginTop:e.spaces.space4},quoteTweet:{backgroundColor:e.colors.transparent,marginTop:e.spaces.space4,marginBottom:0},addImageTextContainer:{alignSelf:"flex-start",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},addImageActionIcon:{marginHorizontal:e.spaces.space4},addImageTextPadding:{marginEnd:e.spaces.space48},imageActions:{alignItems:"center",flexDirection:"row",flexWrap:"wrap",marginTop:e.spaces.space4},blurStyle:{opacity:.5},inputStyle:{width:"100%"},collapsedInputStyle:{flexGrow:1,flexShrink:1},highlightedText:{borderRadius:e.borderRadii.large,paddingVertical:e.spaces.space12,paddingLeft:e.spaces.space12,marginTop:0,marginBottom:0},highlightedTextInner:{marginHorizontal:e.spaces.space4}}))),_t="addButton",yt="addSubtitlesLabel",bt="altTextLabel",ft="attachments",Ct="createPollButton",wt="scheduleOption",vt="taggedUsersLabel",Tt="tweetTextarea_",xt="toolBar",Et=i("xM7j"),St=i("tZIO"),It=i("5mJL"),Rt=i("DNho"),At=i("oSwX"),kt=i("rFBM"),Mt=i("zfvc"),Bt=i("Ujvi"),Dt=i("yTN1"),Nt=i("v6aA"),Ot=i("gpVt"),Lt=i("hOZg"),Ft=i("ll3R"),Pt=i("J0mu"),Ht=i("boUI"),Vt=i("6ZHn"),zt=i("/WPq"),jt=i("wpLu"),Ut=i("pHub"),Wt=i("8A5z"),$t=i("pKoL"),Kt=i("ZvMt"),Gt=i("9Xij");class qt extends r.Component{render(){const{media:e,style:t}=this.props;return r.createElement(E.a,{style:t},this._renderImageGroup(e.length))}_renderImageGroup(e){switch(e){case 1:return this._renderGroupOf1();case 2:return this._renderGroupOf2();case 3:return this._renderGroupOf3();case 4:return this._renderGroupOf4();default:return null}}_renderGroupOf1(){const{media:e}=this.props,t=e&&!!e[0].mediaFile,{width:i,height:a}=e&&!t&&e[0].externalMediaDetails||{};let s=A.a.theme.aspectRatios.landscape;if(t){const t=this.context.featureSwitches.isTrue("media_minimal_image_crop_enabled"),i=this.context.featureSwitches.getNumberValue("media_minimal_image_crop_minimum_aspect_ratio"),a=this.context.featureSwitches.getNumberValue("media_minimal_image_crop_maximum_aspect_ratio");var n,o;if(t)s=Kt.a.getImageAspectRatio(i,a,{width:null==(n=e[0].mediaFile)?void 0:n.width,height:null==(o=e[0].mediaFile)?void 0:o.height})}return r.createElement(Gt.a,{ratio:t?s:i/a},r.createElement(E.a,{style:Xt.mediaPreviewWrapper},this._renderMediaAtIndex(0)))}_renderGroupOf2(){return r.createElement(Gt.a,{ratio:A.a.theme.aspectRatios.landscape},r.createElement(E.a,{style:Xt.mediaPreviewWrapper},this._renderMediaAtIndex(0,Xt.gutterRight),this._renderMediaAtIndex(1)))}_renderGroupOf3(){return r.createElement(Gt.a,{ratio:A.a.theme.aspectRatios.landscape},r.createElement(E.a,{style:Xt.mediaPreviewWrapper},this._renderMediaAtIndex(0,Xt.gutterRight),this._renderColumnWithIndices([1,2])))}_renderGroupOf4(){return r.createElement(Gt.a,{ratio:A.a.theme.aspectRatios.landscape},r.createElement(E.a,{style:Xt.mediaPreviewWrapper},this._renderColumnWithIndices([0,2],Xt.gutterRight),this._renderColumnWithIndices([1,3])))}_renderColumnWithIndices(e,t){return r.createElement(E.a,{style:[Xt.column,t]},this._renderMediaAtIndex(e[0],Xt.gutterBottom),this._renderMediaAtIndex(e[1]))}_renderMediaAtIndex(e,t){var i,a;const{media:s,editable:n,isActive:o,onClickMedia:l,onEditMedia:c,onRemoveMedia:d,onSetMediaPreviewRef:h}=this.props,u=s[e],p=null==(i=u.mediaMetadata)?void 0:i.altText,m=null==(a=u.mediaMetadata)?void 0:a.defaultAltText;return r.createElement($t.a,{accessibilityLabel:p||m,accessibilityRole:"group",enableGif:o,key:u.id,mediaItem:u,onClick:l?l(u.id):void 0,onEdit:c?c(u.id):void 0,onRemove:d(u.id),ref:h,style:[Xt.mediaContainer,t],withAltTextLabel:!!p,withCloseButton:n&&o,withEditButton:c&&n&&o})}}o()(qt,"contextType",Nt.a);const Xt=A.a.create((e=>({column:{flexDirection:"column",flexGrow:1,flexBasis:0},gutterRight:{marginRight:e.spaces.space12},gutterBottom:{marginBottom:e.spaces.space12},mediaContainer:{borderRadius:e.borderRadii.xLarge,transitionProperty:"width",transitionDuration:"0.1s",transitionTimingFunction:"ease-out",overflow:"hidden",flexGrow:1,flexBasis:0},mediaPreviewWrapper:{flexDirection:"row",height:"100%"}})));var Yt=i("S1qy"),Qt=i.n(Yt),Zt=i("cjAp"),Jt=i.n(Zt);const ei=w.a.f0afcc0e,ti=w.a.ha5e2e79,ii=w.a.a3de3b68,ai=w.a.cc2b28fc,si=w.a.g45af04e,ni=w.a.ee9c4013,oi=w.a.af40a8ef,ri=w.a.e68b09b4,li=w.a.ec10ee02,ci=w.a.h735a98d,di=w.a.j499fbcb,hi=w.a.b7d8e3f0,ui=w.a.d1175c78,pi=w.a.bf4e9d79,mi=w.a.e0342f98,gi=w.a.e349147b,_i=w.a.e3a24e4b,yi=w.a.de4669e2,bi=w.a.d2c7a41c,fi=w.a.f7364fa1,Ci=["ja","zh-cn","zh-tw","ko"],wi=w.a.ia24dc8c,vi=r.createElement(Lt.a,null),Ti=r.createElement(Xe.a,null),xi=r.createElement(Ft.a,null),Ei=r.createElement(Pt.a,null),Si={viewType:"schedule_tweet"},Ii={viewType:"add_poll"},Ri={viewType:"add_composer"};class Ai extends r.Component{constructor(e,t){super(e,t),o()(this,"_handleConversationControlsValueChange",(e=>{this.props.updateConversationControlsValue(e),this.props.updateCommunityValue(void 0)})),o()(this,"_handleCommunityValueChange",(e=>{const{updateCommunityValue:t,updateConversationControlsValue:i}=this.props;t(e),i(e?"community_members":"all")})),o()(this,"_triggerConversationControlsImpression",Object(Me.a)((()=>this.context.featureSwitches.isTrue("conversation_controls_limited_replies_creation_enabled")))),o()(this,"_shouldRenderControls",(e=>{const{isFocused:t}=this.state,{isActive:i,isInline:a,isReply:s}=this.props;return i&&!s&&(!a||(t||e))})),o()(this,"_renderConversationControls",(e=>{const{isFocused:t}=this.state,{conversationControlsValue:i,isInline:a,isReply:s}=this.props;if(s||!t&&a||this._triggerConversationControlsImpression(),!this._conversationControlsCreationEnabled)return null;const n=this._shouldRenderControls(e),o=i===oe.a.community_members||this._isScheduled();return n?r.createElement(fe,{disabled:o,onChange:this._handleConversationControlsValueChange,value:i}):null})),o()(this,"_renderMainContent",(()=>{const{additionalToolbarContent:e,autoFocus:t,data:i,editable:a,index:s,isActive:n,isExpanded:o,isInline:l,isInlineReply:c,isLast:d,keyCommandHandlers:h,onTextInputBlur:u,onTypeaheadStateChange:p,positionCursorAtBeginning:m,richTextInputContext:g}=this.props,{cardUrl:_,media:y,pollActive:b,quotedStatus:f,text:C}=i,w=Object(Ot.b)(C)||_&&!Object(Ie.a)(_)&&[_],v=!!y.length||b||!!f,T=0===s&&d,x=this.props.typeaheadWrapper,S=!!g,{element:I,sendTweetCommandName:R,dismissComposerCommandName:A}=g||{},k=g?{dismissComposerCommandName:A,editorState:this.state.editorState,element:I,sendTweetCommandName:R}:void 0,M=c&&!g&&!o;return r.createElement(E.a,{style:gt.textInputArea},r.createElement(E.a,{style:o?gt.inputStyle:gt.collapsedInputStyle},this._renderCommunitiesControls(),r.createElement(x,{contextText:C,isInline:l,isInlineReply:c,onTextUpdated:this._handleTextChange,onTypeaheadStateChange:p},(e=>r.createElement(ve.a,{appTextSize:"headline1",ariaLabel:ii,autoFocus:t||n&&!l,closeButton:n&&(this._deleteNonemptyTweetstormComposerEnabled||this._isEmpty())&&!T?this._renderCloseButton():void 0,contentBelow:this._renderTweetAttachment(),editable:a,inputStyle:[gt.textInputStyle,M&&gt.textInputMobileCollapsed],keyCommandHandlers:h,maxNumberOfLines:S?30:10,multiline:!0,numberOfLines:this._calcNumberOfLines(),onBlur:u,onChange:this._getHandleChange(e),onFilesAdded:this._handleFilesAdded,placeholder:this._getPlaceHolderText(),positionCursorAtBeginning:m,positionCursorAtEnd:!m,ref:this._setTextInputRef,richTextInputContext:k,styleType:"selection",testID:`${Tt}${s}`,value:C}))),w&&!v?r.createElement(Ot.a,{index:s,isCardPreviewTombstoned:Object(Ie.a)(_),urls:w}):null),o?null:e)})),o()(this,"_renderCommunityTweetFromProtectedUserCallout",(()=>this.props.isCommunityTweetFromProtectedUser?r.createElement(dt,null):null)),o()(this,"_renderCommunitiesControls",(()=>{const{index:e,isInline:t,isReply:i,selectedCommunityId:a}=this.props,s=this.context.featureSwitches.isTrue("c9s_participation_enabled");return t||i||0!==e||!s?null:r.createElement(U,{onCommunityValueChange:this._handleCommunityValueChange,selectedCommunityId:a})})),o()(this,"_renderCommunitiesRulesEducation",(()=>this.shouldRenderCommunitiesRules?r.createElement(ne,null):null)),o()(this,"_renderCommunitiesRules",(e=>{const{selectedCommunityId:t}=this.props;return this.shouldRenderCommunitiesRules&&t?r.createElement(Z,{selectedCommunityId:t,showMiddot:!e}):null})),o()(this,"_calcNumberOfLines",(()=>{const{richTextInputContext:e,isInline:t,data:i,isActive:a}=this.props,s=!!e,{media:n,pollActive:o,quotedStatus:r}=i,l=!!n.length||!!o||!!r;return s&&(t||l)||!a?1:4})),o()(this,"_renderScheduledTweetLegend",(()=>{const{scheduledFor:e}=this.props;return r.createElement(pt.a,{onPress:this._handlePressScheduledTweetLegend,scheduledFor:e})})),o()(this,"_handlePressScheduledTweetLegend",(()=>{const{history:e,analytics:t,setActiveParentKey:i}=this.props;e.push("/compose/tweet/schedule"),t.scribe({element:"tweet_legend",action:"click"}),i()})),o()(this,"_renderEmojiPicker",(()=>r.createElement(we.a,{onEmojiSelect:this._handleInsertEmoji,size:"normal",style:this._getEmojiPickerButtonStyles(),textInputRef:this._textInputRef||void 0}))),o()(this,"_getEmojiPickerButtonStyles",Object(Me.a)((()=>[gt.iconEmojiPicker,gt.toolBarButton]))),o()(this,"_isSchedulingDisabled",(()=>{const{conversationControlsValue:e,index:t,isLast:i,data:{pollActive:a,quotedStatus:s,text:n,media:o,mediaTags:r}}=this.props,l=0===t&&i,c=e!==oe.a.all;return Boolean(a||!l||s&&""===n&&!o.length||c||r.length>0)})),o()(this,"_renderSchedulingButton",(()=>r.createElement(P.a,{accessibilityLabel:ti,clientEventContext:Si,disabled:this._isSchedulingDisabled(),hoverLabel:{label:ci},icon:Ei,onClick:this._handleClickScheduler,size:"normal",style:gt.toolBarButton,testID:wt,type:"text"}))),o()(this,"_handleClickScheduler",(()=>{const{analytics:e,history:t,setActiveParentKey:i}=this.props;t.push("/compose/tweet/schedule"),e.scribe({element:"schedule_tweet",action:"click"}),i()})),o()(this,"_renderCloseButton",(()=>{const{onRemoveComposer:e}=this.props;return r.createElement(P.a,{accessibilityLabel:ni,hoverLabel:{label:ri},icon:vi,onPress:e,size:"small",type:"text"})})),o()(this,"_renderTweetAttachment",(()=>{const{data:e,editable:t,isActive:i}=this.props,{media:a,pollActive:s,initialPollChoices:n,initialPollDuration:o,quotedStatus:l}=e;return 0!==a.length||s||l?r.createElement(E.a,{onClick:this._handleFocus,style:[gt.attachmentContainer,gt.tweetAttachmentArea],testID:ft},a.length>0?r.createElement(qt,{editable:t,isActive:i,media:a,onClickMedia:this.hasAttachedImage?this._handleClickMediaDetail:void 0,onEditMedia:this.hasAttachedImage||this.hasAttachedVideo?this._handleClickMediaDetail:void 0,onRemoveMedia:this._handleMediaRemoveFactory,onSetMediaPreviewRef:this._handleSetMediaPreviewRef,style:gt.mediaPreview}):null,i?this._renderMediaActions():null,s?r.createElement(ot,{editable:t,initialChoices:n,initialDuration:o,isActive:i,onInvalid:this._handlePollInvalid,onRemove:this._handlePollRemove,onValid:this._handlePollValid,ref:this._setPollCreatorRef}):null,l?this._renderQuoteTweet(l):null):null})),o()(this,"_renderQuoteTweet",(e=>{const{data:{media:t}}=this.props,i=e.tombstoneInfo;return i&&i.richText?r.createElement(Et.a,null,r.createElement(ut.c,{entities:i.richText.entities,rtl:i.richText.rtl,text:i.richText.text})):r.createElement(ht.a,{isCondensed:t.length>0,style:gt.quoteTweet,tweetId:e.id_str,withLink:!1,withUserHoverCard:!1})})),o()(this,"_renderToolbar",(e=>{const{additionalToolbarContent:t,hidePollAndScheduling:i,isReply:a,richTextInputContext:s,isSelfThreadReply:n,isInlineReply:o}=this.props,l=!!s,c=!o&&!i;return r.createElement(E.a,{style:gt.toolBar,testID:xt},r.createElement(E.a,{style:gt.toolBarIconsContainer},this._renderMediaPickerButton(),this._renderGifButton(),c?this._renderPollButton():null,l?this._renderEmojiPicker():null,c?this._renderSchedulingButton():null),r.createElement(E.a,{style:gt.toolBarIconsContainer},e?this._renderCountdownCircle():null,a&&!n||!e?null:r.createElement(r.Fragment,null,r.createElement(E.a,{style:gt.separator}),this._renderAddComposerButton()),t))})),o()(this,"_addOverflowStyle",(e=>{const{richTextInputContext:t}=this.props;if(!t)return;const i=e.getCurrentContent().getPlainText(),a=i.length,s=this._getParsedTweet(i).validRangeEnd,n=s+1<a;if(this.state.hasOverflowStyle||n){const i=n?s+1:-1;return{editorState:t.updateOverflowStyle&&t.updateOverflowStyle(e,i,this.state.hasOverflowStyle),hasOverflowStyle:n}}return{editorState:e,hasOverflowStyle:n}})),o()(this,"_getHandleChange",Object(Me.a)((e=>t=>{e(t),this._handleTextChange(t)}))),o()(this,"_handleTextChange",(e=>{const{data:{key:t,text:i},onTextChange:a,richTextInputContext:s}=this.props;let n;if(s){n=e.getCurrentContent().getPlainText();const t=s.convertEmojiToEntities(e);this.setState(this._addOverflowStyle(t))}else n=St.a.replaceCarriageReturns(e.target.value);i!==n&&a(n,t)})),o()(this,"_handleClickAltTextShortcut",(()=>{const{analytics:e}=this.props;e.scribe({element:"alt_text_button",action:"click"})})),o()(this,"_handleClickSubtitlesShortcut",(()=>{const{analytics:e}=this.props;e.scribe({element:"subtitles_button",action:"click"})})),o()(this,"_handleClickMediaDetail",(e=>()=>{const{analytics:t,history:i}=this.props;t.scribe({element:"media_detail_button",action:"click"}),(this.hasAttachedImage||this.hasAttachedVideo)&&i.push("/compose/tweet/media",{mediaId:e,tab:this.hasAttachedVideo?this._videoTrimmerEnabled?"trimmer":"subtitles":"crop"})})),o()(this,"_handleFilesAdded",(e=>{const{addToast:t,data:{pollActive:i},onFilesAdded:a}=this.props;i?t({text:ai}):a(e)})),o()(this,"_handleMediaRemoveFactory",(e=>()=>{this.props.onRemoveMedia(this.props.index,e)})),o()(this,"_handleInsertEmoji",(e=>{const{editorState:t}=this.state,{richTextInputContext:i}=this.props;if(!i)return;const a=i.insertTextAtCursor(t,e.text);this._handleTextChange(a)})),o()(this,"_validateMedia",(e=>{const{data:{media:t}}=this.props;return c.c(t.concat(e))})),o()(this,"_handlePollAdd",(()=>{const{analytics:e,index:t,updateSingleComposer:i}=this.props;e.scribe({element:"add_poll",action:"click"}),i({pollActive:!0},t)})),o()(this,"_handlePollRemove",(()=>{const{analytics:e,index:t,updateSingleComposer:i}=this.props;e.scribe({element:"remove_poll",action:"click"}),i({pollActive:!1},t)})),o()(this,"_handlePollInvalid",(()=>{const{data:{pollValid:e},index:t,updateSingleComposer:i}=this.props;e&&i({pollValid:!1},t)})),o()(this,"_handlePollValid",(()=>{const{data:{pollValid:e},index:t,updateSingleComposer:i}=this.props;!e&&i({pollValid:!0},t)})),o()(this,"_handleWrapperClick",(e=>{e.target instanceof Element&&e.target.closest('[role="button"],a,input,textarea,select')||this.focus()})),o()(this,"_handleFocus",(()=>{const{isActive:e,index:t,onFocus:i,setActiveParentKey:a}=this.props;a(),e||(window.requestAnimationFrame((()=>{this._mediaPreviewRef&&this._mediaPreviewRef.playVideo()})),i(t))})),o()(this,"_handleEditorFocus",(()=>this.setState({isFocused:!0}))),o()(this,"_formatCountdownNumber",(e=>wi(Math.ceil(e/this._userLanguageWeight)))),o()(this,"_getPlaceHolderText",(()=>{const{data:{quotedStatus:e,pollActive:t},isReply:i,isSelfThreadReply:a,index:s}=this.props;return e?yi:t?fi:i&&!a?bi:a||s>0?_i:gi})),o()(this,"_getNumberOfAltTextEntries",(()=>{const{data:{media:e}}=this.props;return e.reduce(((e,t)=>{var i;return null!=(i=t.mediaMetadata)&&i.altText?e+1:e}),0)})),o()(this,"_getParsedTweet",Object(Me.a)((e=>{const t=Jt.a[this.props.twitterTextConfigurationVersion];return Qt()(e,t)}))),o()(this,"_isEmpty",(()=>{const{data:e}=this.props;return Object(Re.b)(e)})),o()(this,"_isScheduled",(()=>{const{data:{scheduledFor:e}}=this.props;return Object(Ae.h)(e)})),o()(this,"_setPollCreatorRef",(e=>{this._pollCreatorRef=e})),o()(this,"_handleSetMediaPreviewRef",(e=>{this._mediaPreviewRef=e})),o()(this,"_setTextInputRef",(e=>{this._textInputRef=e}));const{richTextInputContext:i,userLanguage:a,data:{text:s}}=e,{initEditorState:n}=i||{};this._conversationControlsCreationEnabled=!0===this.context.featureSwitches.getValueWithoutScribeImpression("conversation_controls_limited_replies_creation_enabled"),this._deleteNonemptyTweetstormComposerEnabled=this.context.featureSwitches.isTrue("responsive_web_delete_nonempty_tweetstorm_composer_enabled"),this._userLanguageWeight=a&&Ci.indexOf(a)>-1?2:1,this.state={editorState:n&&n(s),hasOverflowStyle:!1,isFocused:!1}}componentDidUpdate(e){(this.hasExternalMedia||this.props.data.media.some((e=>e.mediaFile&&!(e.mediaFile instanceof Se.a)&&e.mediaFile.isVideo)))&&e.isActive&&!this.props.isActive&&this._mediaPreviewRef&&this._mediaPreviewRef.pauseVideo()}focus(){this._textInputRef&&this._textInputRef.focus()}render(){const{isActive:e,isExpanded:t,isInline:i,isLast:a,loggedInUser:s,withAvatar:n,windowWidth:o}=this.props,l=!this._isEmpty(),c=this._shouldRenderControls(l),d=o<A.a.theme.breakpoints.small;return r.createElement(E.a,{onClick:this._handleWrapperClick,onFocus:this._handleFocus,style:[gt.root,!e&&gt.blurStyle]},this._renderCommunityTweetFromProtectedUserCallout(),r.createElement(It.a,{avatarCell:r.createElement(r.Fragment,null,n?r.createElement(Rt.a.Consumer,null,(({avatarSize:e})=>r.createElement(At.default,{accessibilityLabel:s?s.name:void 0,screenName:s?s.screen_name:void 0,size:e,style:gt.avatar,uri:s?s.profile_image_url_https:void 0,withLink:i}))):null,a?null:r.createElement(E.a,{style:[gt.conversationLine,!n&&gt.conversationLineWithOverflow]})),avatarCellStyle:t?gt.avatarContainerExpanded:gt.avatarContainer,cellStyle:gt.rightColumn},this._renderScheduledTweetLegend(),r.createElement(E.a,{onFocus:this._handleEditorFocus,style:gt.inputArea},r.createElement(kt.a,{allowDragDrop:!this.mediaAttachDisabled,onDragEnter:this._handleFocus,onFilesAdded:this._handleFilesAdded,style:gt.dragDrop},(e=>r.createElement(r.Fragment,null,r.createElement(E.a,{style:[gt.composeBoxContainer]},this._renderMainContent()))))),this._renderCommunitiesRulesEducation(),r.createElement(E.a,{style:[c&&gt.controlsContainer,d?gt.mobileControlsLayout:gt.controlsLayout]},this._renderConversationControls(l),this._renderCommunitiesRules(d)),r.createElement(Mt.b,{show:e&&t},this._renderToolbar(l))))}_renderMediaPickerButton(){const{data:{media:e},setActiveParentKey:t}=this.props,i=this.mediaAttachDisabled,a=e.length<3;return r.createElement(ke.a,{acceptGifs:0===e.length,disabled:i,multiple:a,onChange:this._handleFilesAdded,onPress:t,style:[gt.toolBarButton,gt.firstToolBarButton],type:"text"})}_renderGifButton(){const{data:{media:e,pollActive:t},history:i,loggedInUser:a,setActiveParentKey:s}=this.props,n=t||e.length||!a;return r.createElement(xe.a,{enabled:!n,gifSearchKeySource:Ee.a.Composition,history:i,onPress:s})}_renderPollButton(){const{data:{media:e,pollActive:t,quotedStatus:i},loggedInUser:a}=this.props,s=this._isScheduled(),n=!(!(t||e.length||i||s)&&a);return r.createElement(P.a,{accessibilityLabel:ei,clientEventContext:Ii,disabled:n,hoverLabel:{label:li},icon:xi,onPress:this._handlePollAdd,size:"normal",style:gt.toolBarButton,testID:Ct,type:"text"})}_renderMediaActions(){const{data:{gifMetadata:e,media:t,mediaTags:i}}=this.props,a=0!==i.length,s=t.some((e=>e.mediaFile&&e.mediaFile.isGif))||this.hasExternalMedia;return this.hasAttachedImage||this.hasAttachedVideo||e||s?r.createElement(E.a,{style:gt.imageActions},e&&e.url&&e.provider?r.createElement(E.a,{style:gt.addImageTextPadding},r.createElement(Te.a,{gifUrl:e.url,provider:e.provider})):null,this.hasAttachedImage&&!this._isScheduled()?r.createElement(I.c,{accessibilityLabel:ui,color:"gray700",link:"/compose/tweet/tags",style:[gt.addImageTextContainer,gt.addImageTextPadding]},a?this._renderTaggedUsers():this._renderTagPeopleLabel()):null,this.hasAttachedImage||s?r.createElement(I.c,{accessibilityLabel:di({numberOfImages:t.length}),color:"gray700",link:{pathname:"/compose/tweet/media",state:{mediaId:t[0].id,tab:"alt_text"}},onPress:this._handleClickAltTextShortcut,style:gt.addImageTextContainer},this._renderAltTextLabel()):null,this._captionsUploadEnabled&&this.hasAttachedVideo?this._renderSubtitlesLabel():null):null}_renderTagPeopleLabel(){return r.createElement(I.c,{color:"gray700",size:"subtext2"},r.createElement(Ht.a,{style:gt.addImageActionIcon}),ui)}_renderTaggedUsers(){const{data:{mediaTags:e},loggedInUser:t}=this.props,i=e.map((e=>({name:e.data.name,screen_name:e.data.screen_name,type:e.type,user_id:e.data.id_str})));return r.createElement(I.c,{color:"gray700",size:"subtext2",testID:vt},r.createElement(Vt.a,{style:gt.addImageActionIcon}),r.createElement(Bt.a,{loggedInUserId:null==t?void 0:t.id_str,users:i}))}_renderAltTextLabel(){const{data:{media:e}}=this.props,t=e[0].mediaMetadata;return this.hasAttachedAltText?e.length>1?r.createElement(I.c,{color:"gray700",size:"subtext2",testID:bt},r.createElement(jt.a,{style:gt.addImageActionIcon}),hi({numberOfAltTextEntries:this._getNumberOfAltTextEntries()})):r.createElement(I.c,{color:"gray700",numberOfLines:1,size:"subtext2",testID:bt},r.createElement(jt.a,{style:gt.addImageActionIcon}),null==t?void 0:t.altText):r.createElement(I.c,{color:"gray700",size:"subtext2",testID:bt},r.createElement(zt.a,{style:gt.addImageActionIcon}),di({numberOfImages:e.length}))}_renderSubtitlesLabel(){const{data:{media:e}}=this.props,t=this.attachedSubtitles?Ut.a:Wt.a;return r.createElement(I.c,{accessibilityRole:"button",color:"gray700",link:{pathname:"/compose/tweet/media",state:{mediaId:e[0].id,tab:"subtitles"}},onPress:this._handleClickSubtitlesShortcut,size:"subtext2",style:gt.addImageTextContainer,testID:yt},r.createElement(t,{accessibilityLabel:this.attachedSubtitles?mi:void 0,style:gt.addImageActionIcon}),this.attachedSubtitles?this.attachedSubtitles.displayName:pi)}_renderCountdownCircle(){const{data:{text:e},twitterTextConfigurationVersion:t}=this.props,i=Jt.a[t],a=this._getParsedTweet(e).weightedLength;return r.createElement(Dt.a,{count:a,formatNumber:this._formatCountdownNumber,maxCount:i.maxWeightedTweetLength,warningCount:260})}_renderAddComposerButton(){const{disableAddTweet:e,loggedInUser:t,isInline:i,onAddComposer:a}=this.props,s=this._isEmpty(),n=this._isScheduled(),o=e||s||n||!t;return r.createElement(P.a,{accessibilityLabel:si,clientEventContext:Ri,disabled:o,hoverLabel:{label:oi},icon:Ti,link:!i||s||o?void 0:"/compose/tweet",onPress:a,size:"small",testID:_t,type:"secondary"})}get pollChoices(){const{data:{pollActive:e}}=this.props;return e&&this._pollCreatorRef?this._pollCreatorRef.choices:void 0}get pollDuration(){const{data:{pollActive:e}}=this.props;return e&&this._pollCreatorRef?this._pollCreatorRef.duration:void 0}get mediaAttachDisabled(){const{data:{media:e,pollActive:t},loggedInUser:i}=this.props,a=e.length,s=e.some((e=>{var t;return null==(t=e.mediaFile)?void 0:t.isGif})),n=e.some((e=>e.mediaFile&&!(e.mediaFile instanceof Se.a)&&e.mediaFile.isVideo));return 4===a||s||n||t||this.hasExternalMedia||!i}get hasAttachedImage(){const{data:{media:e}}=this.props;return e.some((e=>{var t;return null==(t=e.mediaFile)?void 0:t.isImage}))}get hasAttachedVideo(){const{data:{media:e}}=this.props,t=e.some((e=>{var t;return null==(t=e.mediaFile)?void 0:t.isVideo}));return!!t&&(this._videoTrimmerEnabled=this.context.featureSwitches.isTrue("responsive_web_video_trimmer_enabled"),this._captionsUploadEnabled=this.context.featureSwitches.isTrue("responsive_web_captions_upload_enabled"),(this._videoTrimmerEnabled||this._captionsUploadEnabled)&&t)}get attachedSubtitles(){var e;const{data:{media:t}}=this.props;if(!this.hasAttachedVideo)return;const i=t.find((e=>e.mediaFile&&!(e.mediaFile instanceof Se.a)&&e.mediaFile.isVideo));return null==i||null==(e=i.mediaMetadata)?void 0:e.subtitles}get hasAttachedAltText(){return this._getNumberOfAltTextEntries()>0}get hasExternalMedia(){const{data:{media:e}}=this.props;return e.some((e=>!!e.externalMediaDetails))}get shouldRenderCommunitiesRules(){const{index:e,isInline:t,isReply:i,selectedCommunityId:a}=this.props,s=this.context.featureSwitches.isTrue("c9s_enabled");return Boolean(!t&&!i&&0===e&&(s&&a))}}o()(Ai,"contextType",Nt.a),o()(Ai,"defaultProps",{twitterTextConfigurationVersion:"defaults",withAvatar:!0,conversationControlsValue:"all",updateConversationControlsValue:()=>{}});var ki=Object(le.a)(Ai);const Mi=r.createElement(I.c,{weight:"bold"}),Bi=r.createElement(I.c,{color:"link"}),Di=e=>`@${e}`;var Ni=i("SrIh");const Oi=e=>(null==e?void 0:e.screen_name)||"",Li=({communityName:e,excludedRecipients:t,inReplyToStatus:i,loggedInUserId:a})=>{const s={replyToOne:({userName:e})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"e34022a7"},r.cloneElement(Bi,null,w.a.b50e199a({userName:Di(e)}))),replyToTwo:({userOneName:e,userTwoName:t})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"bfd9c99a"},r.cloneElement(Bi,null,w.a.f2e4dd37({replyUserName:Di(e),otherUserName:Di(t)}))),replyToThree:({userOneName:e,userTwoName:t,userThreeName:i})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"g7a1000e"},r.cloneElement(Bi,null,w.a.eccfddc3({userOneName:Di(e),userTwoName:Di(t),userThreeName:Di(i)}))),replyToMany:({userOneName:e,userTwoName:t,othersCount:i})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"i558c201"},r.cloneElement(Bi,null,w.a.h758cd22({userOneName:Di(e),userTwoName:Di(t),othersCount:i}))),communityReplyToOne:({communityName:e,userName:t})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"j935bcde",communityName:e},r.cloneElement(Bi,null,w.a.e9f8a0eb({userName:Di(t)}))),communityReplyToTwo:({communityName:e,userOneName:t,userTwoName:i})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"i7bd9c8e",communityName:e},r.cloneElement(Bi,null,w.a.df7e9fbc({replyUserName:Di(t),otherUserName:Di(i)}))),communityReplyToThree:({communityName:e,userOneName:t,userTwoName:i,userThreeName:a})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"cfa0049d",communityName:e},r.cloneElement(Bi,null,w.a.b45fa505({userOneName:Di(t),userTwoName:Di(i),userThreeName:Di(a)}))),communityReplyToMany:({communityName:e,userOneName:t,userTwoName:i,othersCount:a})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"jfc8e4b4",communityName:e},r.cloneElement(Bi,null,w.a.a4383815({userOneName:Di(t),userTwoName:Di(i),othersCount:a}))),exclusiveReplyToOne:({userName:e})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"a4e11010"},r.cloneElement(Bi,null,w.a.ff792e35({userName:Di(e)})),r.cloneElement(Mi,null,w.a.a18d8f1c)),exclusiveReplyToTwo:({userOneName:e,userTwoName:t})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"cf1b3321"},r.cloneElement(Bi,null,w.a.g7d5e985({replyUserName:Di(e),otherUserName:Di(t)})),r.cloneElement(Mi,null,w.a.af82725c)),exclusiveReplyToThree:({userOneName:e,userTwoName:t,userThreeName:i})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"c83d647e"},r.cloneElement(Bi,null,w.a.fe5a61e9({userOneName:Di(e),userTwoName:Di(t),userThreeName:Di(i)})),r.cloneElement(Mi,null,w.a.f7126257)),exclusiveReplyToMany:({userOneName:e,userTwoName:t,othersCount:i})=>r.createElement(w.a.I18NFormatMessage,{$i18n:"fec57cab"},r.cloneElement(Bi,null,w.a.bc9dd514({userOneName:Di(e),userTwoName:Di(t),othersCount:i})),r.cloneElement(Mi,null,w.a.de5071ba))},n=c.a({inReplyToStatus:i,loggedInUserId:a}).filter((({id_str:e})=>t.indexOf(e)<0)),{user:o,exclusivity_info:l}=i.retweeted_status||i,[d,h]=n.filter((({id_str:e})=>e!==o.id_str)),[u,p,m]=[o,d,h].map(Oi),g=n.length-2;switch(n.length){case 0:return Object(Ni.a)("Compose reply context should not have 0 recipients"),null;case 1:return e?s.communityReplyToOne({communityName:e,userName:u}):l?s.exclusiveReplyToOne({userName:u}):s.replyToOne({userName:u});case 2:return e?s.communityReplyToTwo({communityName:e,userOneName:u,userTwoName:p}):l?s.exclusiveReplyToTwo({userOneName:u,userTwoName:p}):s.replyToTwo({userOneName:u,userTwoName:p});case 3:return e?s.communityReplyToThree({communityName:e,userOneName:u,userTwoName:p,userThreeName:m}):l?s.exclusiveReplyToThree({userOneName:u,userTwoName:p,userThreeName:m}):s.replyToThree({userOneName:u,userTwoName:p,userThreeName:m});default:return e?s.communityReplyToMany({communityName:e,userOneName:u,userTwoName:p,othersCount:g}):l?s.exclusiveReplyToMany({userOneName:u,userTwoName:p,othersCount:g}):s.replyToMany({userOneName:u,userTwoName:p,othersCount:g})}};var Fi=r.memo(Li),Pi=i("fs1G"),Hi=i("BLtI"),Vi=i("kY28");function zi(e){null==e||e.preventDefault()}const ji=A.a.create((e=>({replyUsersContainer:{flexDirection:"row",minHeight:e.spaces.space12,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:0},grid:{flexGrow:1,flexShrink:1},repliesTextContainer:{flexGrow:1},repliesMessage:{flexGrow:1,paddingBottom:e.spaces.space16,paddingTop:e.spaces.space4},conversationLineContainer:{alignItems:"center"},conversationLine:{backgroundColor:e.colors.gray200,flexGrow:1,minHeight:0,width:e.componentDimensions.conversationLineWidth,marginBottom:e.spaces.space4}})));var Ui=({communityName:e,excludedRecipients:t,inReplyToStatus:i,loggedInUserId:a,onPress:s,shouldDisplayRepliesText:n,showParentTweet:o=!0})=>r.createElement(E.a,null,o?r.createElement(Hi.b,{conversationPosition:{isStart:!0},linkableQuotedTweet:!1,linkify:!1,onAnalyticsClick:Pi.a,onAvatarClick:zi,onEntityClick:zi,onMediaClick:zi,onReplyContextClick:zi,replyContext:Vi.a.ReplyContextTypes.None,tweet:i,withAvatarLink:!1,withCardLinks:!0,withInlineMedia:!1,withQuotedTweetLinks:!0,withSocialContext:!1,withTimestampLink:!1,withUserHoverCard:!1}):null,r.createElement(E.a,{style:ji.replyUsersContainer},r.createElement(It.a,{avatarCell:o?r.createElement(E.a,{style:ji.conversationLine}):null,avatarCellStyle:ji.conversationLineContainer,cellStyle:ji.repliesTextContainer,style:ji.grid},n?r.createElement(I.c,{accessibilityRole:"button",color:"gray700",onPress:s,style:o&&ji.repliesMessage},r.createElement(Fi,{communityName:e,excludedRecipients:t,inReplyToStatus:i,loggedInUserId:a})):null))),Wi=i("Tb0w"),$i=i("1YZw"),Ki=i("xVN5"),Gi=i("pidX"),qi=i("5oBF"),Xi=i("JYYi"),Yi=i("P1r1"),Qi=i("RqPI"),Zi=i("qlwE"),Ji=i("XOJV"),ea=i("G6rE"),ta=i("AspN"),ia=i("oEGd"),aa=i("hqKg");const sa=e=>e.parentTweetId||(e.isInline?Xi.a.homeTimeline:Xi.a.modal),na=(e,t)=>{const i=sa(t);return Ki.n(e,i)},oa=(e,t)=>{const i=sa(t);return Ki.p(e,i)},ra=(e,t)=>{const i=sa(t);return t.selectedCommunityIdFromLocationState?oe.a.community_members:Ki.o(e,i)},la=(e,t)=>{const i=sa(t);return Ki.m(e,i)||t.selectedCommunityIdFromLocationState},ca=(e,t)=>{const i=ya(e,t),a=(null==i?void 0:i.community_id_str)||la(e,t),s=a?u.a.select(e,a):void 0;return s?s.name:void 0},da=(e,t)=>{const i=sa(t);return Ki.q(e,i)},ha=(e,t)=>{const i=sa(t);return Ki.l(e,i)},ua=e=>(t,i)=>{const a=((e,t)=>t.location.state)(0,i);return a?e(a):void 0},pa=Object(aa.createSelector)(((e,t)=>t.activeUser),ea.e.selectLoggedInUser,((e,t)=>e||t)),ma=(e,t)=>t.parentTweetId||ga(e,t)||_a(e,t),ga=(e,t)=>{const{location:{query:i}}=t;return i&&"string"==typeof i.in_reply_to?i.in_reply_to:void 0},_a=ua((e=>e.inReplyToStatusId)),ya=(e,t)=>{const i=ma(e,t);return i?Ji.a.selectHydrated(e,i):void 0},ba=(e,t)=>t.location.pathname.indexOf("/intent/")>-1,fa=ua((e=>e.hasArticleNudge)),Ca=ua((e=>e.convoCardData)),wa=ua((e=>e.externalMedia)),va=ua((e=>e.externalMediaFiles)),Ta=ua((e=>e.previewTweetId)),xa=ua((e=>e.defaultText)),Ea=(e,t)=>{const i=xa(e,t),a=Object(Gi.a)(t.location);return(ba(0,t)||((e,t)=>t.location.pathname.indexOf("/compose/tweet")>-1)(0,t))&&a?a:i},Sa=ua((e=>e.quotedStatusId)),Ia=ua((e=>e.quotedStatus)),Ra=(e,t)=>((e,t)=>t.quotedStatus?t.quotedStatus:Ia(e,t))(e,t)||((e,t)=>{const i=Sa(e,t);return i?Ji.a.selectHydratedMemoized(e,i):void 0})(e,t),Aa=ua((e=>e.isSelfThreadReply)),ka=ua((e=>e.positionCursorAtBeginning)),Ma=ua((e=>e.promotedContent)),Ba=({mediaIds:e,...t})=>t,Da={addComposer:Ki.a,addToast:$i.b,createLocalApiErrorHandler:Object(m.d)("SCREEN_COMPOSE_V2"),createNudge:Ki.d,deletePreviewTweet:qi.c,fetchTweetIfNeeded:Ji.a.fetchOneIfNeeded,removeComposer:Ki.h,resetDraft:Ki.i,retweet:Ji.a.retweet,recordNudgeAction:Ki.f,recordNudgeResult:Ki.g,schedule:Ki.k,draftTweet:Ki.e,send:Ki.t,updateActiveComposerIndex:Ki.v,updateConvoCardState:Wi.b,updateConversationControlsValue:Ki.x,updateCommunityValue:Ki.w,uploadMedia:ta.o,addMedia:ta.b,processMultipleMedia:ta.f,removeMediaUpload:ta.h,updateSingleComposer:Ki.z,setActiveParentKey:Ki.u,copyDataFromInlineComposerToModalComposer:Ki.b,copyDataFromInlineReplyComposerToModalComposer:Ki.c};var Na=Object(ia.e)((()=>Object(aa.createStructuredSelector)({activeComposerIndex:ha,activeUser:pa,composerData:Object(aa.createSelector)(na,Ea,Ra,ta.i,((e,t,i,a)=>e.map(((e,s)=>({...Ba(e),media:a.filter((t=>e.mediaIds.some((e=>e===t.id)))),quotedStatus:0===s?i:void 0,text:0===s&&t?t:e.text}))))),conversationControlsValue:ra,dataSaverMode:Yi.k,excludedRecipients:oa,externalMedia:wa,externalMediaFiles:va,hasArticleNudge:fa,inReplyToStatus:ya,inReplyToStatusId:ma,isIntentRoute:ba,isSelfThreadReply:Aa,isSending:da,positionCursorAtBeginning:ka,loggedInUser:ea.e.selectLoggedInUser,prepopulatedText:Ea,previewTweetId:Ta,promotedContent:Ma,scheduledFor:Ki.r,selectedCommunityId:la,selectedCommunityName:ca,sendingProgress:Ki.s,convoCardData:Ca,undoTweetSettings:Zi.p,userLanguage:Qi.n,quotedStatusId:Sa})),Da),Oa=i("45mF"),La=i("c0ZR"),Fa=i("W5XZ"),Pa=i("MXY2"),Ha=i("I8M8"),Va=i("eyty"),za=i("ymux"),ja=i("0pUJ");const Ua=(e,t)=>Object(h.q)(e,h.i);var Wa=Object(p.a)().propsFromState((()=>({shouldShowHideReplyTip:Ua}))).propsFromActions((({conversationModule:e={}})=>({addFlag:h.o,addToast:$i.b,block:ea.e.block,createLocalApiErrorHandler:Object(m.d)("NUDGE"),hideReply:Ji.a.hideReply,mute:ja.a,recordNudgeAction:Ki.f,recordNudgeResult:Ki.g,unblock:ea.e.unblock,unmute:ea.e.unmute,updateDismissCause:e&&e.updateDismissCause}))),$a=i("VjLy"),Ka=i("95Se"),Ga=i("xKuM");const qa=w.a.cd33a61c,Xa=w.a.g97558f6,Ya=w.a.cd80d930,Qa=w.a.b0476eb2,Za=w.a.j24c37b2;class Ja extends r.Component{constructor(...e){super(...e),o()(this,"_handleHideMoreInfo",(()=>{const{hideEducation:e}=this.props;e()}))}render(){const{isSmallBreakPoint:e}=this.props;return r.createElement(Mt.b,{animateMount:!0,duration:"longer",show:!0,type:"fade"},r.createElement(E.a,{style:es.moreInfoContainer},r.createElement(Ga.a,{leftControl:r.createElement(P.a,{icon:r.createElement(Ka.a,{onClick:this._handleHideMoreInfo}),pullLeft:!0,type:"text"}),style:es.moreInfoAppBar,title:"More Info",withBottomBorder:!0}),r.createElement(E.a,{style:es.moreInfoContentContainer},r.createElement(I.c,{color:"normal",size:"headline1",style:es.headlineText,weight:"bold"},qa),r.createElement(I.c,{color:"gray700",style:es.moreInfoFirstDescription},Ya),r.createElement(I.c,{color:"normal",size:"headline1",style:es.headlineText,weight:"bold"},Xa),r.createElement(I.c,{color:"gray700",style:es.moreInfoSecondDescription},Qa),e&&r.createElement(P.a,{onClick:this._handleHideMoreInfo,style:es.confirmationButton,type:"neutral"},Za))))}}const es=A.a.create((e=>({headlineText:{marginBottom:e.spaces.space12},confirmationButton:{marginVertical:e.spaces.space20},moreInfoAppBar:{borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge},moreInfoContainer:{borderRadius:e.borderRadii.xLarge},moreInfoContentContainer:{padding:e.spaces.space20,paddingBottom:0},moreInfoFirstDescription:{marginBottom:e.spaces.space16},moreInfoSecondDescription:{marginBottom:e.spaces.space16}})));var ts=i("euJ+"),is=i("1bnC"),as=i("Qwev"),ss=i("yrzJ"),ns=i("eb3s"),os=i("sgih"),rs=i("P2xQ");const ls=Object.freeze({PotentiallyToxicTweet:"PotentiallyToxicTweet",ReviseOrMute:"ReviseOrMute",ReviseOrBlock:"ReviseOrBlock",ReviseOrHideThenBlock:"ReviseOrHideThenBlock"}),cs=Object.freeze({BlockUser:"BlockUser",CancelOnBlockUserPrompt:"CancelOnBlockUserPrompt",CancelTweet:"CancelTweet",CloseApp:"CloseApp",HideReply:"HideReply",MuteUser:"MuteUser",NudgeNotShown:"NudgeNotShown",ReviseTweet:"ReviseTweet",SendTweet:"SendTweet"}),ds=Object.freeze({BlockUser:"BlockUser",CancelComposer:"CancelComposer",CloseApp:"CloseApp",HideReply:"HideReply",MuteUser:"MuteUser",SaveTweetToDrafts:"SaveTweetToDrafts",SentTweet:"SentTweet",TweetSentWithoutShowingNudge:"TweetSentWithoutShowingNudge"}),hs=w.a.ic011119,us=w.a.f6b7745a,ps=w.a.a75cc0f8,ms=w.a.a6450e83,gs=w.a.a9fd20be,_s=w.a.i2b9632d,ys=w.a.e133be4e,bs=w.a.ge5067bb,fs=w.a.ea626ab3,Cs=w.a.i62a03aa,ws=w.a.h3032750,vs=w.a.af250eb6,Ts=w.a.ib147a39,xs=w.a.e8ff17e5,Es=w.a.e3275464;class Ss extends r.Component{constructor(...e){super(...e),o()(this,"_isNudgeEducationEnabled",this.context.featureSwitches.isTrue("responsive_web_second_degree_replies_nudge_education_enabled")),o()(this,"state",{loadingSecondaryButton:!1,showMoreInfo:!1}),o()(this,"_renderInnerBody",(()=>{const{loadingSecondaryButton:e}=this.state;return r.createElement(r.Fragment,null,r.createElement(I.c,{align:"center",color:"normal",size:"headline1",style:Is.headlineText,weight:"bold"},this._getHeadline()),r.createElement(I.c,{align:"center",color:"gray700"},this._getDescription()),r.createElement(I.c,{align:"center",color:"link",onClick:this._handleMoreInfo,style:Is.moreInfoButton},ws),r.createElement(E.a,{style:Is.buttons},r.createElement(P.a,{onPress:this._handleRevise,style:Is.button,type:"secondary"},xs),r.createElement(P.a,{onPress:this._handleSecondaryAction,style:Is.button,type:"secondary"},e?this._renderSpinner():this._getSecondaryActionLabel()),r.createElement(P.a,{onPress:this._handleSend,style:Is.button,type:"secondary"},Es)))})),o()(this,"_renderSpinner",(()=>{const{nudgeType:e}=this.props,t=e===ls.ReviseOrMute?rs.g:e===ls.ReviseOrBlock?vs:Ts;return r.createElement(as.a,{accessibilityLabel:t,style:Is.spinner})})),o()(this,"_renderBlockSheet",(()=>{const{recipient:{screen_name:e}}=this.props,t=r.createElement(ss.a,{color:"normal",screenName:e}),i=r.createElement(ss.a,{screenName:e});return r.createElement(ns.a,{cancelButtonLabel:Cs,confirmButtonLabel:ms,confirmButtonType:"destructive",headline:r.createElement(w.a.I18NFormatMessage,{$i18n:"ja6527ba"},t),onCancel:this._handleBlockCancel,onConfirm:this._handleBlockUser,text:r.createElement(w.a.I18NFormatMessage,{$i18n:"a899eb22"},i)})})),o()(this,"_getDescription",(()=>{const{nudgeType:e,recipient:t}=this.props,i=r.createElement(ss.a,{screenName:t.screen_name});switch(e){case ls.ReviseOrMute:return r.createElement(w.a.I18NFormatMessage,{$i18n:"d98723c4"},i);case ls.ReviseOrBlock:return r.createElement(w.a.I18NFormatMessage,{$i18n:"fa1a3797"},i);case ls.ReviseOrHideThenBlock:return r.createElement(w.a.I18NFormatMessage,{$i18n:"fa2ffaa7"},i);default:return null}})),o()(this,"_getHeadline",(()=>{const{nudgeType:e}=this.props;switch(e){case ls.ReviseOrMute:return hs;case ls.ReviseOrBlock:return us;case ls.ReviseOrHideThenBlock:return ps;default:return null}})),o()(this,"_getSecondaryActionLabel",(()=>{const{nudgeType:e}=this.props;switch(e){case ls.ReviseOrMute:return rs.f;case ls.ReviseOrBlock:return ms;case ls.ReviseOrHideThenBlock:return bs;default:return null}})),o()(this,"_handleSecondaryAction",(()=>{const{nudgeType:e}=this.props;switch(this.setState({loadingSecondaryButton:!0}),e){case ls.ReviseOrMute:this._handleMuteUser();break;case ls.ReviseOrBlock:this._handleBlockUser();break;case ls.ReviseOrHideThenBlock:this._handleHideReplyThenBlock();break;default:return}})),o()(this,"_handleSend",(()=>{const{onSend:e}=this.props;this._recordNudgeAction(cs.SendTweet),e()})),o()(this,"_handleBlockCancel",(()=>{const{onDiscard:e,showBlockModal:t}=this.props;t&&(this._recordNudgeAction(cs.CancelOnBlockUserPrompt),this._handleHideReply()),e()})),o()(this,"_handleBlockUser",(()=>{const{addToast:e,block:t,onDiscard:i,recipient:a,showBlockModal:s,unblock:n}=this.props;this._recordNudgeAction(cs.BlockUser),t(a.id_str).then((()=>{s&&this._handleHideReply(),this._recordNudgeResult(ds.BlockUser),i(),e({action:{label:ys,onAction:()=>{n(a.id_str).then((()=>{e({text:_s})})).catch(this._createApiErrorHandler())}},text:gs})})).catch(this._createApiErrorHandler())})),o()(this,"_handleMuteUser",(()=>{const{addToast:e,mute:t,onDiscard:i,recipient:a,unmute:s}=this.props;this._recordNudgeAction(cs.MuteUser),t(a.id_str).then((()=>{this._recordNudgeResult(ds.MuteUser),i(),e({action:{label:is.a,onAction:()=>{s(a.id_str).then((()=>{e({text:Object(rs.d)(a.screen_name)})})).catch(this._createApiErrorHandler())}},text:Object(rs.b)(a.screen_name)})})).catch(this._createApiErrorHandler())})),o()(this,"_handleHideReplyThenBlock",(()=>{const{addFlag:e,shouldShowHideReplyTip:t,hidePopover:i,setShowBlockModal:a,setShowHideReplyEducation:s,showHideReplyEducation:n}=this.props;if(i(),n)s(!1);else if(t)return e(h.i),void s(!0);a(!0)})),o()(this,"_handleHideReply",(()=>{const{addToast:e,conversationId:t,hideReply:i,inReplyToStatusId:a,updateDismissCause:s}=this.props;this._recordNudgeAction(cs.HideReply),i(a,{conversation_id:t}).then((()=>{this._recordNudgeResult(ds.HideReply),s&&s({entryId:`tweet-${a}`,feedbackKeys:[ts.d]}),e({text:fs})})).catch(this._createApiErrorHandler())})),o()(this,"_handleRevise",(()=>{const{onRevise:e}=this.props;this._recordNudgeAction(cs.ReviseTweet),e()})),o()(this,"_handleCancelHideReplyEducation",(()=>{const{setShowHideReplyEducation:e}=this.props;e(!1),this._handleRevise()})),o()(this,"_handleBeforeWindowUnload",(()=>{this._recordNudgeAction(cs.CloseApp),this._recordNudgeResult(ds.CloseApp)})),o()(this,"_handleMoreInfo",(()=>{this.setState({showMoreInfo:!0})})),o()(this,"_hideMoreInfo",(()=>{this.setState({showMoreInfo:!1})})),o()(this,"_recordNudgeAction",(e=>{const{nudgeId:t,recordNudgeAction:i}=this.props;i({nudgeId:t,nudgeActionType:e})})),o()(this,"_recordNudgeResult",(e=>{const{nudgeId:t,recordNudgeResult:i}=this.props;i({nudgeId:t,nudgeResultType:e})})),o()(this,"_createApiErrorHandler",(()=>this.props.createLocalApiErrorHandler({showToast:!0})))}componentDidMount(){window.addEventListener("beforeunload",this._handleBeforeWindowUnload)}componentWillUnmount(){window.removeEventListener("beforeunload",this._handleBeforeWindowUnload)}render(){const{screenWidth:e,showBlockModal:t,showHideReplyEducation:i}=this.props,{showMoreInfo:a}=this.state;if(t)return this._renderBlockSheet();if(i)return r.createElement($a.a,{onCancel:this._handleCancelHideReplyEducation,onConfirm:this._handleHideReplyThenBlock});const s=e<A.a.theme.breakpoints.small;return this._isNudgeEducationEnabled?s?r.createElement(os.a,{accessibilityRole:"alertdialog",allowBackNavigation:!1,enableMaskForDismiss:!0,onMaskClick:this._handleRevise,style:[Is.container,Is.smallBreakPointContainer,a&&Is.noPadding],type:"bottom",withMask:!0},a?r.createElement(Ja,{hideEducation:this._hideMoreInfo,isSmallBreakPoint:!0}):this._renderInnerBody()):r.createElement(r.Fragment,null,a&&r.createElement(Ja,{hideEducation:this._hideMoreInfo}),r.createElement(E.a,{style:Is.container},!a&&this._renderInnerBody())):r.createElement(os.a,{accessibilityRole:"alertdialog",allowBackNavigation:!1,enableMaskForDismiss:!0,onMaskClick:this._handleRevise,style:Is.container,type:"center",withMask:!0},this._renderInnerBody())}}o()(Ss,"contextType",Nt.a);const Is=A.a.create((e=>({container:{alignItems:"center",backgroundColor:e.colors.cellBackground,borderRadius:e.borderRadii.xLarge,padding:e.spaces.space20,paddingBottom:e.spaces.space12},smallBreakPointContainer:{borderRadius:e.borderRadii.none},noPadding:{padding:0},headlineText:{marginBottom:e.spaces.space12},buttons:{marginTop:e.spaces.space12,width:"100%"},button:{width:"100%",marginBottom:e.spaces.space16},moreInfoButton:{marginTop:e.spaces.space4},spinner:{marginTop:"5px"}})));var Rs=Wa(Ss),As=i("OiMc"),ks=i("cHvH");class Ms extends r.Component{constructor(...e){super(...e),o()(this,"state",{nudgeDismissed:!1,showBlockModal:!1,showHideReplyEducation:!1,shouldHidePopover:!1}),o()(this,"_isNudgeEducationEnabled",this.context.featureSwitches.isTrue("responsive_web_second_degree_replies_nudge_education_enabled")),o()(this,"_renderNudge",(()=>{const{location:e,inReplyToStatus:t,nudgeId:i,nudgeType:a,onDiscard:s,screenWidth:n}=this.props,{showBlockModal:o,showHideReplyEducation:l}=this.state,{featureSwitches:c}=this.context,d=null==t?void 0:t.conversation_id_str,h=e.state&&e.state.previousPath&&e.state.previousPath.split("/status/").slice(-1)[0].split("/")[0];return a&&i&&t&&t.id_str?r.createElement(Rs,{conversationId:d,conversationModule:h&&this._getConversationModule(h,c),hidePopover:this._hidePopover,inReplyToStatusId:t.id_str,nudgeId:i,nudgeType:a,onDiscard:s,onRevise:this._handleDismissNudge,onSend:this._handleSend,recipient:t.user,screenWidth:n,setShowBlockModal:this.setShowBlockModal,setShowHideReplyEducation:this.setShowHideReplyEducation,showBlockModal:o,showHideReplyEducation:l}):null})),o()(this,"_getConversationModule",Object(Me.a)(((e,t)=>Object(za.a)({focalTweetId:e,featureSwitches:t})))),o()(this,"_handleSend",(()=>{const{onSend:e}=this.props;this._handleDismissNudge(),e()})),o()(this,"_handleDismissNudge",(e=>{const{clearNudgeType:t,nudgeType:i,screenWidth:a}=this.props;e&&e.stopPropagation(),this._isNudgeEducationEnabled&&a>=A.a.theme.breakpoints.small&&i&&this.setState({nudgeDismissed:!0}),t()})),o()(this,"_hidePopover",(()=>{this.setState({shouldHidePopover:!0})})),o()(this,"setShowHideReplyEducation",(e=>{this.setState({showHideReplyEducation:e})})),o()(this,"setShowBlockModal",(e=>{this.setState({showBlockModal:e})}))}render(){const{children:e,nudgeType:t,screenWidth:i}=this.props,{nudgeDismissed:a,shouldHidePopover:s}=this.state;return this._isNudgeEducationEnabled&&i>=A.a.theme.breakpoints.small&&!s?r.createElement(As.a,{disabled:a,onDismiss:this._handleDismissNudge,renderContent:this._renderNudge,visibilityBehavior:t?As.a.VISIBILITY_BEHAVIOR.forceVisible:As.a.VISIBILITY_BEHAVIOR.forceHidden,withArrow:!0,withFixedPosition:!0,withMask:!!t},e):r.createElement(r.Fragment,null,e,this._renderNudge())}}o()(Ms,"contextType",Nt.a);var Bs=e=>r.createElement(ks.a,null,(({screenWidth:t})=>r.createElement(Ms,s()({},e,{screenWidth:t})))),Ds=i("7myi"),Ns=i("7nmT"),Os=i.n(Ns),Ls=i("vbWy"),Fs=i("Rp9C"),Ps=i("k49u");const Hs=w.a.i859a9d3,Vs=w.a.a7478929,zs=w.a.adf527d2,js=w.a.b25c5b2a,Us=w.a.cc85b9f5,Ws=w.a.a3f10d61,$s=w.a.d74da9b8,Ks=w.a.c3ebec63,Gs=w.a.b6266b34,qs=w.a.a59566d7,Xs=w.a.g30d7ec5,Ys=w.a.d484fca9,Qs=w.a.c51ba396,Zs=w.a.ef2fa90b;var Js={defaultToast:{text:zs},[Ps.a.OverStatusUpdateLimit]:{toast:{text:Vs,action:{label:Hs,link:"https://support.twitter.com/articles/15364"}}},[Ps.a.DuplicateStatusError]:{toast:{text:js}},[Ps.a.CurrentUserSuspended]:{toast:{text:Us}},[Ps.a.InReplyToTweetNotFound]:{toast:{text:Ws}},[Ps.a.MentionLimitInTweetExceeded]:{toast:{text:$s}},[Ps.a.UrlLimitInTweetExceeded]:{toast:{text:Ks}},[Ps.a.HashtagLimitInTweetExceeded]:{toast:{text:Gs}},[Ps.a.CashtagLimitInTweetExceeded]:{toast:{text:qs}},[Ps.a.HashtagLengthLimitInTweetExceeded]:{toast:{text:Xs}},[Ps.a.AttachmentTypesLimitInTweetExceeded]:{toast:{text:Ys}},[Ps.a.StatusMalwareError]:{toast:{text:Qs,action:{label:Hs,link:"https://support.twitter.com/articles/90491"}}},[Ps.a.StatusTooLongError]:{toast:{text:Zs}},showToast:!0},en=i("N5qz"),tn="tweetButton",an="tweetButtonInline",sn=i("aITJ"),nn=i("sCk0"),on=i("JYMr"),rn=i("rziq"),ln=i("jTgF"),cn=i("3A2y"),dn=i("s1N3"),hn=i("4FGy"),un=i("+d3d"),pn=i("mN6z"),mn=i("sXY3");const gn=w.a.d28215f0,_n=w.a.ec909a54,yn=w.a.dad5a4b8,bn=w.a.e65aed64,fn=w.a.d8222374,Cn=w.a.j890123a,wn=w.a.bb01231c,vn=w.a.d4ab68e2,Tn=w.a.d8af8a4c,xn=w.a.d09d4c05,En=w.a.i2209530,Sn=w.a.bf9b89e4,In=w.a.f277e949,Rn=w.a.b551cd22,An=w.a.f026a7fa,kn=w.a.a5d4fda0,Mn=w.a.ib067d6a,Bn=l.canUseDOM&&document.documentElement&&"scrollBehavior"in document.documentElement.style,Dn={component:"article_nudge"},Nn={viewType:"send_tweet"},On=Object.freeze({Original:"original",Reply:"reply",Quote:"quote",Thread:"thread"});class Ln extends r.Component{constructor(e,t){super(e,t),o()(this,"_getParentKey",(()=>{const{isInline:e,parentTweetId:t}=this.props;return t||(e?Xi.a.homeTimeline:Xi.a.modal)})),o()(this,"_updateSingleComposer",((e,t)=>{const{updateSingleComposer:i}=this.props;return i({updates:e,index:t,parentKey:this._getParentKey()})})),o()(this,"_resetDraft",(()=>{const{resetDraft:e}=this.props;e({parentKey:this._getParentKey(),isPreview:this.isPreview})})),o()(this,"_syncTexts",(()=>{const{composerData:e}=this.props,{textMap:t}=this.state;e.forEach(((e,i)=>{const a=t[e.key];"string"==typeof a&&a!==e.text&&this._updateSingleComposer({text:a},i)}))})),o()(this,"_hasGif",(e=>e.gifMetadata||e.media.some((e=>e.mediaFile&&e.mediaFile.isGif)))),o()(this,"_hasPhoto",(e=>e.media&&e.media.some((e=>e.mediaFile&&e.mediaFile.isImage)))),o()(this,"_hasVideo",(e=>e.media&&e.media.some((e=>e.mediaFile&&e.mediaFile.isVideo&&!e.mediaFile.isGif)))),o()(this,"_handleDeletePreviewTweet",(()=>{const{deletePreviewTweet:e,previewTweetId:t}=this.props;t&&e(t)})),o()(this,"_handleAnimateComplete",(()=>{const{activeComposerIndex:e,onHandleAppBarHeight:t}=this.props,i=Os.a.findDOMNode(this._composerRefs[e]);if(i instanceof window.Element){const{top:e,bottom:a}=i.getBoundingClientRect(),s=Math.max(e,window.scrollY);if(s<window.pageYOffset||a>window.innerHeight){const e=t?s-t()-14:s-14,i=Math.max(e,0);window.requestAnimationFrame((()=>{Bn?window.scrollTo({top:i,left:0,behavior:"smooth"}):window.scrollTo(0,i)}))}}})),o()(this,"_handleFetchTweetIfNeeded",(()=>{const{createLocalApiErrorHandler:e,inReplyToStatus:t,inReplyToStatusId:i,fetchTweetIfNeeded:a,quotedStatus:s,quotedStatusId:n}=this.props;!t&&i&&a(i).catch(e(Fa.a)),!s&&n&&a(n).catch(e(Fa.a))})),o()(this,"_blockHistory",((e,t)=>{const{isInline:i}=this.props,a=!i&&/unsent/.test(e.pathname),s=!i&&!/\/compose\/tweet\/?$/.test(e.pathname);return this.shouldShowDiscardConfirmation&&"POP"===t&&s?(this.setState({showDiscardTweetConfirmation:!0}),!1):this._canSaveDraft&&a&&"PUSH"===t?this.shouldShowDiscardConfirmation?(this.setState({showDiscardTweetConfirmation:!0,navigatingToOutbox:a}),!1):(this._resetDraft(),!0):!this.shouldShowBackgroundSendConfirmation||"POP"!==t||!s||(this._cancelAllMediaUploads(),!1)})),o()(this,"_getKeyCommandHandlers",(()=>{const{typeaheadActive:e}=this.state;return e?this._keyCommandHandlersForActiveTypeahead:this._keyCommandHandlers})),o()(this,"handleTweetOrRetweet",(()=>{this._scribe({section:"composition",element:"send_tweet",action:"click"});if(this._areComposersValid())return this.isRetweet?this._handleRetweet():this._handleTweet()})),o()(this,"_render",(e=>{var t,i;const{activeUser:a,addComposer:n,addToast:o,composeHeader:l,composerData:c,conversationControlsValue:d,copyDataFromInlineComposerToModalComposer:h,customizePropsForSingleComposerItem:u,history:p,isModal:m,isInline:g,isSending:_,isSelfThreadReply:y,inReplyToStatus:b,location:f,parentTweetId:C,positionCursorAtBeginning:w,richTextInputContext:v,scheduledFor:T,selectedCommunityId:x,typeaheadWrapper:S,userLanguage:I,windowWidth:R}=this.props,{errorMessage:A,focused:k,nudgeId:M,nudgeType:B,showDiscardTweetConfirmation:D,typeaheadActive:N,shouldDisableButton:O}=this.state,L=!m&&N,F=g?0:this.props.activeComposerIndex,H=L||g?[c[F]]:c,V=this._areComposersValid(),z=this.hasNonCompliantQuote&&this.isRetweet,j=g?E.a:nn.a,U=g?{}:{onAnimateComplete:m?void 0:this._handleAnimateComplete},W=O||!V||z||this.isCommunityTweetFromProtectedUser,$=g&&en.a.isOneColumnSquishedLayout(R)||this.isCommunityTweet;return r.createElement(E.a,{ref:e?this._setHiddenRootRef:this._setRootRef,style:[!C&&Fn.root,e&&Fn.hidden]},g?this._renderProgressBar():null,A&&r.createElement(E.a,{style:Fn.inlineCallout},r.createElement(te.a,{action:null!=(t=A.action)&&t.label&&null!=(i=A.action)&&i.link?{label:A.action.label,link:A.action.link}:void 0,text:A.text,type:"danger"})),r.createElement(E.a,{onFocus:this._handleFocus,style:[Fn.content,C&&Fn.contentInlineReply,m&&Fn.contentModal]},b?this._renderReplyContext(e):null,l,r.createElement(j,U,H.map(((t,i)=>{const l=Object(Ae.h)(t.scheduledFor),C=c.indexOf(t),A=u(t,i,H),D=r.createElement(Bs,{clearNudgeType:this.clearNudgeType,inReplyToStatus:b,location:f,nudgeId:M,nudgeType:B,onDiscard:this._handleDismissComposerFromNudge,onSend:this._handleSendTweet},m||g?r.createElement(P.a,{clientEventContext:Nn,disabled:W,onPress:this.handleTweetOrRetweet,size:"normal",style:Fn.inlineSendButton,testID:m?tn:an,type:"primary"},Object(Pa.a)({inReplyToStatus:!!b,isSelfThreadReply:!!y,isQuoteTweet:!!this.isQuoteTweet,isRetweet:!!this.isRetweet,isScheduled:!!l,isThread:this.isThread})):null),O=this._getSingleComposerDataWithLatestText(t);return r.createElement(E.a,{key:t.key},r.createElement(ki,s()({addToast:o,additionalToolbarContent:D,autoFocus:!e&&this.isInlineReply&&k,conversationControlsValue:d,data:O,disableAddTweet:c.length>=25,editable:!_&&!!a,hidePollAndScheduling:$,history:p,index:C,isActive:C===F&&!_,isCommunityTweetFromProtectedUser:this.isCommunityTweetFromProtectedUser,isExpanded:0!==i||this._shouldBeExpanded(e),isInline:g,isInlineReply:this.isInlineReply,isLast:g||C===c.length-1,isReply:!!b||this.isInlineReply,isSelfThreadReply:!!y,keyCommandHandlers:this._getKeyCommandHandlers(),loggedInUser:a,onAddComposer:g?h:n,onFilesAdded:this._handleAddMediaFiles(C),onFocus:this._handleComposerFocus,onRemoveComposer:this._handleRemoveComposer,onRemoveMedia:this._handleMediaRemove,onTextChange:this._handleTextChange,onTextInputBlur:this._handleTextOnBlur(O.key,i),onTypeaheadStateChange:this._handleTypeaheadStateChange,positionCursorAtBeginning:!!w,ref:this._setComposerRef(C),richTextInputContext:v,scheduledFor:T,selectedCommunityId:x,setActiveParentKey:this._setActiveParentKey,twitterTextConfigurationVersion:"version3",typeaheadActive:N,typeaheadWrapper:S,updateCommunityValue:this._updateCommunityValue,updateConversationControlsValue:this._updateConversationControlsValue,updateSingleComposer:this._updateSingleComposer,userLanguage:I,windowWidth:R},A)))}))),D?this._canSaveDraft?r.createElement(ns.a,{cancelButtonLabel:vn,confirmButtonLabel:En,headline:Tn,onCancel:this._handleConfirmDiscardTweet,onConfirm:this._handleDraftTweet,onMaskClick:this._handleCancelDiscardTweet,text:xn}):r.createElement(ns.a,{confirmButtonLabel:vn,confirmButtonType:"destructive",headline:this.isThread?Cn:fn,onCancel:this._handleCancelDiscardTweet,onConfirm:this._handleConfirmDiscardTweet,text:wn}):null,r.createElement(E.a,{style:[_&&Fn.mask]})))})),o()(this,"_renderReplyContext",(e=>{const{activeUser:t,excludedRecipients:i,isInline:a,isSelfThreadReply:s,inReplyToStatus:n,selectedCommunityName:o}=this.props;if(n&&this._shouldBeExpanded(e))return r.createElement(Ui,{communityName:o,excludedRecipients:i,inReplyToStatus:n,key:i.join(),loggedInUserId:t?t.id_str:void 0,onPress:this._handleViewRecipients,shouldDisplayRepliesText:!s,showParentTweet:!a})})),o()(this,"_setRootRef",(e=>{e&&(this._root=e)})),o()(this,"_setHiddenRootRef",(e=>{e&&(this._hiddenExpandedRoot=e)})),o()(this,"_handleTweet",(()=>{const{composerData:e}=this.props,{scheduledFor:t}=e[0];this.setState({errorMessage:void 0}),t?Object(Ae.h)(t)&&this._handleScheduleTweet():this._checkToxicAndSendTweet()})),o()(this,"_handleTweetError",((e,t)=>i=>{const{analytics:a,createLocalApiErrorHandler:s}=this.props;if(Object(ln.d)(i)&&i.code===Ha.b.CANCELED)return a.scribeAction(e),Promise.resolve();const n=Object(ln.b)(i);if(n)return this.setState({errorMessage:n}),Promise.resolve();s({...t||Object(Oa.a)(void 0,!1)})(i),this.setState({errorMessage:{text:kn}})})),o()(this,"_handleScheduleTweet",(()=>{const{addToast:e,composerData:t,excludedRecipients:i,inReplyToStatus:a,schedule:s}=this.props,n=this._getSingleComposerDataWithLatestText(t[0]);s({excludedRecipients:i,inReplyToStatus:a,scheduleData:n}).then((i=>{this.setState({tweetsSentOrScheduled:!0});const a=Object(Ae.c)(n.scheduledFor);if(a){const s=Object(Ae.b)(a),n=Object(Ae.i)(a),o=Rn({scheduleDate:s,scheduleTime:n});e({text:o,action:{label:In,link:"/compose/tweet/unsent/scheduled"}}),this._scribeTweetSent(t[0],{...i,id_str:i.scheduled_id_str},{isScheduled:!0})}this._updateConvoCardState(),this._close()})).catch(this._handleTweetError("schedule_tweet_cancel"))})),o()(this,"_handleDraftTweet",(()=>{const{addToast:e,composerData:t,draftTweet:i,excludedRecipients:a,inReplyToStatus:s}=this.props,n=this._getSingleComposerDataWithLatestText(t[0]);this._recordNudgeResult(ds.SaveTweetToDrafts),i({excludedRecipients:a,inReplyToStatus:s,draftData:n}).then((i=>{this.setState({showDiscardTweetConfirmation:!1}),e({text:Sn,action:{label:In,link:"/compose/tweet/unsent/drafts"}}),this._scribeTweetSent(t[0],{...i,id_str:i.draft_id_str},{isDraftTweet:!0}),this._updateConvoCardState(),this._close()})).catch(this._handleTweetError("draft_tweet_cancel"))})),o()(this,"_handleSendTweet",(()=>{const{addToast:e,analytics:t,conversationControlsValue:i,composeSemanticCoreId:a,excludedRecipients:s,hasArticleNudge:n,history:o,inReplyToStatus:r,isSelfThreadReply:l,location:d,activeUser:h,selectedCommunityId:u,selectedCommunityName:p,promotedContent:m,send:g}=this.props,_=this.isPreview,{nudgeId:y}=this.state,b=this.props.composerData.map((e=>this._getSingleComposerDataWithLatestText(e))),f=Object(Ae.c)(b[0].scheduledFor);if(f){const t=Object(Ae.b)(f),i=Object(Ae.i)(f),a=Rn({scheduleDate:t,scheduleTime:i});return e({text:a,action:{label:In,link:""}}),void this._close()}if(s.length>0&&t.scribe({element:"mentions",action:"edited"}),this._conversationControlsCreationEnabled)if("community"===i)t.scribe({action:"send_community_tweet"});else if("by_invitation"===i){const e=this._getSingleComposerDataWithLatestText(b[0]).text,i=Object(c.d)(e);t.scribe({action:i?"send_mentioned_tweet_with_mentions":"send_mentioned_tweet_without_mentions"})}else"followers"===i&&t.scribe({action:"send_my_followers_tweet"});const C=b.map(((e,t)=>({...e,pollChoices:this._composerRefs[t]?this._composerRefs[t].pollChoices:void 0,pollDuration:this._composerRefs[t]?this._composerRefs[t].pollDuration:void 0}))),w=this._isNudgeTweetypieEnabled&&this._isSecondaryDegreeNudge?{nudge_enabled:!0,nudge_types:["ReviseOrBlock","ReviseOrMute","ReviseOrHideThenBlock"],nudge_testing_keyword_enabled:!0,previous_nudge_id:y}:{},v=(null==r?void 0:r.community_id_str)||u,T=v?`8.31.${v}`:"",x=a?v?[a,T].join(","):a:T;g({...w,sendData:C,communityValue:v,conversationControlsValue:i,excludedRecipients:s,inReplyToStatus:r,isSelfThreadReply:l,promotedContent:m,composeSemanticCoreId:x,isPreview:_}).then((t=>{if(_||this.setState({tweetsSentOrScheduled:!0}),t.map(((e,t)=>this._scribeTweetSent(b[t],e,{hasArticleNudge:n}))),t.length>1&&this._scribeThreadSent(b,t,"thread_send_success"),!_){let i=t.length>1?bn:yn;if(v&&p){const e=p,a=t.length;i=_n({numOfTweets:a,communityName:e})}e({text:i,action:{label:In,link:`/${h?h.screen_name:"i"}/status/${t[0].id_str}`}})}if(this._isNudgeEnabled&&y){const e=t[0].id_str;this._isShowNudgeEnabled?this._recordNudgeResult(ds.SentTweet,e):this._recordNudgeResult(ds.TweetSentWithoutShowingNudge,e)}this.isInlineReply&&this.setState({focused:!1}),this._updateConvoCardState(),this._close()})).catch((e=>{var i;const{sentTweets:a=[]}=e,s=Array.isArray(e.errors)&&(null==(i=e.errors[0])?void 0:i.code),r=null==e?void 0:e.url,l=null==e?void 0:e.status,c={message:e.type,event_info:s?`${s}`:void 0,status_code:l,url:r};if(!this._isNudgeTweetypieEnabled||439!==s)throw a.map(((e,t)=>this._scribeTweetSent(b[t],e)),{hasArticleNudge:n}),Object(ln.d)(e)&&e.code===Ha.b.CANCELED||t.scribe({action:"send_tweet_failure",data:c}),b.length>1&&this._scribeThreadSent(b,a,"thread_send_failure"),a.length&&o.replace({pathname:d.pathname,state:{...Object(cn.a)(d.state||{},"quotedStatus"),inReplyToStatusId:a[a.length-1].id_str,isSelfThreadReply:!0}}),e;{var h;const t=null==(h=e.errors[0])?void 0:h.nudge,i=t.id,a=t.nudge_type,s=a.charAt(0).toUpperCase()+a.slice(1);this.setState({nudgeType:s,nudgeId:i})}})).catch(this._handleTweetError("send_tweet_cancel",Js))})),o()(this,"_checkToxicAndSendTweet",(()=>{var e,t;const{activeUser:i,composerData:a,createNudge:s,inReplyToStatus:n,isSelfThreadReply:o}=this.props,{hasNudged:r}=this.state,l=null==n||null==(e=n.entities)||null==(t=e.user_mentions)?void 0:t.some((({screen_name:e})=>e===(null==i?void 0:i.screen_name))),c=this._getSingleComposerDataWithLatestText(a[0]).text;this._isSecondaryDegreeNudge=!(o||!l||!s||!c),!this._isNudgeTweetypieEnabled&&this._isNudgeEnabled&&!r&&this._isSecondaryDegreeNudge?(this.setState({shouldDisableButton:!0}),this._checkToxicWithTimeout(c).then((e=>{e.showNudge||this._handleSendTweet()})).finally((()=>{this.setState({shouldDisableButton:!1})}))):this._handleSendTweet()})),o()(this,"_makeTimeout",(()=>new Promise(((e,t)=>setTimeout(e,1500))))),o()(this,"_checkToxicWithTimeout",(e=>{const{inReplyToStatus:t,location:i}=this.props;return Promise.race([this._checkToxic(e),this._makeTimeout()]).then((e=>{var a,s,n,o,r;const l=null==e||null==(a=e.create_nudge)||null==(s=a.nudge)||null==(n=s.nudge_type)?void 0:n.__typename,c=null==e||null==(o=e.create_nudge)||null==(r=o.nudge)?void 0:r.id;this.setState({nudgeId:c});const d=null==t?void 0:t.user.muting,h=l===ls.ReviseOrMute&&d,u=i.state&&i.state.previousPath.includes("/hidden"),p=l===ls.ReviseOrHideThenBlock&&u;if(l){if(this.context.featureSwitches.isTrue("responsive_web_second_degree_replies_nudge_show_enabled"),this.context.featureSwitches.isTrue("responsive_web_second_degree_replies_nudge_get_enabled"),this._isShowNudgeEnabled&&!h&&!p)return this.setState({nudgeType:l,hasNudged:!0}),{showNudge:!0};this._recordNudgeAction(cs.NudgeNotShown)}return{}})).catch((()=>({})))})),o()(this,"_checkToxic",(e=>{const{createNudge:t,inReplyToStatusId:i,parentTweetId:a=i,inReplyToStatus:s}=this.props;return t(e,a,null==s?void 0:s.conversation_id_str)})),o()(this,"clearNudgeType",(()=>{this.setState({nudgeType:void 0})})),o()(this,"_setActiveParentKey",(()=>{const{setActiveParentKey:e}=this.props;e(this._getParentKey())})),o()(this,"_scribeTweetSent",((e,t,{isScheduled:i=!1,isDraftTweet:a=!1,hasArticleNudge:s=!1}={})=>{const n=e.scheduledTweetId?"schedule_edit_":"schedule_",o=e.draftTweetId?"draft_edit_":"draft_",r=a?o:i?n:"send_",l={items:[Fs.a.getTweetItem(t)]},c=e.pollActive&&e.pollValid,d=e.media.some((e=>{var t;return!(null==(t=e.mediaMetadata)||!t.altText)})),h=this.props.isInline?"inline_reply":"tweet_box_dialog";if(this._scribe({action:`${r}tweet`},l),a||!e.draftTweetId||e.scheduledTweetId||this._scribe({action:`${r}draft_tweet`},l),this.isQuoteTweet&&(this._scribe({action:"retweet_with_comment"},l),s&&this._scribe({...Dn,element:"result",action:"retweet_with_comment"},l)),this.isReply&&this._scribe({component:h,action:`${r}reply`},l),c&&this._scribe({action:`${r}poll_tweet`},l),this._hasPhoto(e)&&(this._scribe({action:`${r}photo_tweet`},l),d&&this._scribe({action:`${r}photo_tweet_with_alt_text`},l)),this._hasVideo(e)&&this._scribe({action:`${r}video_tweet`},l),e.gifMetadata){const i=t.id_str&&Fs.a.getGifSearchItemForTweet(t.id_str,e.gifMetadata);this._scribe({element:"remote",action:`${r}gif_tweet`},{items:i?[i]:[]});const a=e.media.some((e=>{var t;return!(null==(t=e.mediaMetadata)||!t.defaultAltText)}));(d||a)&&this._scribe({element:"remote",action:`${r}gif_tweet_with_alt_text`},{event_info:d?"user_entered":"from_provider",items:i?[i]:[]})}else this._hasGif(e)&&(this._scribe({element:"local",action:`${r}gif_tweet`},l),d&&this._scribe({element:"local",action:`${r}gif_tweet_with_alt_text`},l))})),o()(this,"_scribeThreadSent",((e,t,i)=>{const{inReplyToStatus:a}=this.props,s={items:[Fs.a.getSendThreadItem(e,t.length,!!a)]};this._scribe({action:i},s)})),o()(this,"_scribeRetweet",(e=>{const{hasArticleNudge:t}=this.props,i={items:[Fs.a.getTweetItem(e)]};this._scribe({action:"retweet"},i),t&&this._scribe({...Dn,element:"result",action:"retweet"},i)})),o()(this,"_handleRetweet",(()=>{const{composerData:e,createLocalApiErrorHandler:t,retweet:i}=this.props,a=e[0].quotedStatus;a&&(this._scribeRetweet(a),i(a.id_str,{}).then((e=>{this.setState({tweetsSentOrScheduled:!0}),this._close()}),t(Ls.a)))})),o()(this,"handleDismissComposer",(()=>{this.shouldShowDiscardConfirmation?this.setState({showDiscardTweetConfirmation:!0}):this.shouldShowBackgroundSendConfirmation?this._cancelAllMediaUploads():this._close()})),o()(this,"_handleDismissComposerFromNudge",(()=>{this.shouldShowBackgroundSendConfirmation?this._cancelAllMediaUploads():this._close()})),o()(this,"_cancelAllMediaUploads",(()=>{this.props.composerData.forEach((e=>e.media.forEach((e=>e.uploading&&e.uploader&&e.uploader.cancel()))))})),o()(this,"_handleConfirmDiscardTweet",(()=>{const{analytics:e,hasArticleNudge:t}=this.props,i=this._canSaveDraft?"draft":"send";this.setState({showDiscardTweetConfirmation:!1}),this._recordNudgeResult(ds.CancelComposer),this._close(),e.scribeAction(`${i}_tweet_discard`),t&&this._scribe({...Dn,element:"result",action:"cancel"})})),o()(this,"_handleCancelDiscardTweet",(()=>{this.setState({showDiscardTweetConfirmation:!1},(()=>{this._restoreFocusToActiveComposer()}))})),o()(this,"_restoreFocusToActiveComposer",(()=>{const{activeComposerIndex:e}=this.props;void 0!==e&&this._composerRefs[e]&&this._composerRefs[e].focus()})),o()(this,"_close",(()=>{const{history:e,isSending:t,onCloseComposer:i}=this.props;t||this._resetDraft(),this.state.navigatingToOutbox?this._canSaveDraft?e.push("/compose/tweet/unsent/drafts"):e.push("/compose/tweet/unsent/scheduled"):i&&i()})),o()(this,"_handleComposerFocus",(e=>{this._composerRefs[e]?this.props.updateActiveComposerIndex(e):setTimeout((()=>{this._restoreFocusToActiveComposer()}),0)})),o()(this,"_handleFocus",(()=>{const{getTweetHeight:e}=this.props,{focused:t}=this.state;t||(this.isInlineReply&&this._scribe({element:"inline_reply",action:"reply"}),this.setState({focused:!0},(()=>{if(e&&this._hiddenExpandedRoot){const t=this._hiddenExpandedRoot.getBoundingClientRect().height+e();this._handleHeightChanged(t)}})))})),o()(this,"_handleHeightChanged",(e=>{const{onHeightChanged:t,onAnimationStarted:i,onAnimationEnded:a}=this.props;i&&i("none"),t&&t(e),window.requestAnimationFrame((()=>{a&&a()}))})),o()(this,"_handleTypeaheadStateChange",(e=>{this.setState({typeaheadActive:e})})),o()(this,"_handleRemoveComposer",(()=>{const{activeComposerIndex:e,composerData:t,history:i,location:a,removeComposer:s}=this.props;0===e&&t[0].quotedStatus&&i.replace({pathname:a.pathname,state:Object(cn.a)(a.state||{},"quotedStatus")}),s(),setTimeout(this._restoreFocusToActiveComposer)})),o()(this,"_handleViewRecipients",(()=>{const{excludedRecipients:e,history:t,inReplyToStatus:i}=this.props;this._setActiveParentKey(),t.push({pathname:"/compose/tweet/recipients",state:{excludedRecipients:e,inReplyToStatus:i}})})),o()(this,"_handleTextChange",((e,t)=>{const{textMap:i}=this.state,{activeComposerIndex:a,isInline:s,setValidity:n}=this.props;if(this.setState({textMap:{...i,[t]:e}},(()=>{n&&n(this._areComposersValid())})),sn.b.isIOS()){const t=s?0:a;this._updateSingleComposer({text:e},t)}})),o()(this,"_handleTextOnBlur",Object(Me.a)(((e,t)=>()=>{const{textMap:i,tweetsSentOrScheduled:a}=this.state,{composerData:s}=this.props,n=i[e],o=s.some((t=>t.key===e));"string"==typeof n&&!a&&o&&this._updateSingleComposer({text:n},t)}))),o()(this,"_updateConversationControlsValue",(e=>{if(!this._conversationControlsCreationEnabled)return;const{updateConversationControlsValue:t}=this.props;t(e,this._getParentKey())})),o()(this,"_updateCommunityValue",(e=>{const{composerData:t,updateCommunityValue:i,selectedCommunityIdFromLocationState:a,location:s,history:n}=this.props,{errorMessage:o}=this.state;this._isCommunitiesEnabled&&(a&&n.replace({pathname:s.pathname,state:Object(cn.a)(s.state||{},"selectedCommunityId")}),t[0].pollActive&&e&&(this._updateSingleComposer({pollActive:!1},0),this.setState({errorMessage:{text:gn}})),(null==o?void 0:o.text)===gn&&this.setState({errorMessage:void 0}),i(e))})),o()(this,"_renderProgressBar",(()=>{const{sendingProgress:e,isSending:t}=this.props;return r.createElement(on.a,{progress:t?Math.max(e,.02):0,style:[Fn.progressBar]})})),o()(this,"_updateConvoCardState",(()=>{const{convoCardData:e,updateConvoCardState:t}=this.props;if(e){const{cardId:i,nextState:a}=e;a&&i&&t(i,{cardState:a})}})),o()(this,"_attachExternalMedia",(e=>t=>Promise.all(t.map((e=>Object(La.a)(e)))).then(this._handleAddMediaFiles(e)))),o()(this,"_handleAddMediaFiles",(e=>t=>{const{addMedia:i,addToast:a,composerData:s,dataSaverMode:n,processMultipleMedia:o,removeMediaUpload:r,uploadMedia:l}=this.props,c=s[e];c.pollActive||i(t,{location:Va.d.Tweet}).then((t=>{const i=t.map((e=>e.id));if(Ln._validateMedia(c,t)){const a=c.media.map((e=>e.id));this._updateSingleComposer({mediaIds:Object(dn.a)(a.concat(i))},e),o(t,{onFailure:this._handleMediaRemoveFactory(e)}).then((e=>{n||l(e.map((e=>e.id)),{preUpload:!0})}))}else a({text:Mn}),r(i)}))})),o()(this,"_handleMediaRemoveFactory",(e=>t=>this._handleMediaRemove(e,t))),o()(this,"_handleMediaRemove",((e,t)=>{const{composerData:i,removeMediaUpload:a}=this.props,{media:s,mediaTags:n}=i[e],o=((e,...t)=>Object(hn.a)(e,t))(s.map((e=>e.id)),t),r=o.length>0?n:[];this._updateSingleComposer({mediaIds:o,gifMetadata:void 0,mediaTags:r},e),a(t),this.setState({errorMessage:void 0})})),o()(this,"_setComposerRef",(e=>t=>{this._composerRefs[e]=t})),o()(this,"_shouldBeExpanded",(e=>{const{composerData:t,parentTweetId:i}=this.props,{focused:a}=this.state;if(e||a)return!0;const s=!Object(Re.b)(this._getSingleComposerDataWithLatestText(t[0]));return!i||s})),o()(this,"_areComposersValid",(()=>{const{composerData:e}=this.props,t=e[0].quotedStatus,i=t&&t.community_id_str;return this.isRetweet&&!i||e.every((e=>Object(Re.d)(this._getSingleComposerDataWithLatestText(e))))})),o()(this,"_areComposersEmptyOrUnchanged",(()=>{const{composerData:e,prepopulatedText:t}=this.props;return e.every((e=>Object(Re.c)(this._getSingleComposerDataWithLatestText(e),t)))})),o()(this,"_getSingleComposerDataWithLatestText",(e=>{const{textMap:t}=this.state;return"string"==typeof t[e.key]?{...e,text:t[e.key]}:e})),o()(this,"_recordNudgeAction",(e=>{const{recordNudgeAction:t}=this.props,{nudgeId:i}=this.state;i&&t({nudgeId:i,nudgeActionType:e})})),o()(this,"_recordNudgeResult",((e,t)=>{const{recordNudgeResult:i}=this.props,{nudgeId:a}=this.state;a&&i(t?{nudgeId:a,nudgeResultType:e,tweetId:t}:{nudgeId:a,nudgeResultType:e})})),this.state={focused:!1,showDiscardTweetConfirmation:!1,textMap:{},tweetsSentOrScheduled:!1,typeaheadActive:!1,shouldDisableButton:!1},this._composerRefs={},this._conversationControlsCreationEnabled=!0===this.context.featureSwitches.getValueWithoutScribeImpression("conversation_controls_limited_replies_creation_enabled"),this._throttledSyncTexts=Object(un.a)(this._syncTexts,1e3,{leading:!0,trailing:!1}),this._keyCommandHandlers={[rn.b]:this.handleTweetOrRetweet,[rn.a]:this.handleDismissComposer},this._keyCommandHandlersForActiveTypeahead={[rn.b]:this.handleTweetOrRetweet},this._isNudgeEnabled=!0===this.context.featureSwitches.getValueWithoutScribeImpression("responsive_web_second_degree_replies_nudge_get_enabled"),this._isShowNudgeEnabled=!0===this.context.featureSwitches.getValueWithoutScribeImpression("responsive_web_second_degree_replies_nudge_show_enabled"),this._isNudgeTweetypieEnabled=!0===this.context.featureSwitches.getValueWithoutScribeImpression("responsive_web_second_degree_replies_nudge_tweetypie_enabled"),this._isCommunitiesEnabled=this.context.featureSwitches.isTrue("c9s_enabled"),this._canComposePreview=!!this.context.userClaims&&this.context.userClaims.isTrueAndEnabled("subscriptions_feature_1003")}UNSAFE_componentWillMount(){const{onRef:e}=this.props;e&&e(this)}componentDidMount(){const{convoCardData:e,externalMedia:t,externalMediaFiles:i,history:a,isIntentRoute:s,isInline:n,location:o,prepopulatedText:r,setValidity:l}=this.props;if(this._unblockHistory=this.props.history.block(this._blockHistory),t.length>0&&this._attachExternalMedia(0)(t),i.length>0&&this._handleAddMediaFiles(0)(i),this._handleFetchTweetIfNeeded(),this._handleDeletePreviewTweet(),r||e&&e.cardUrl){const t={};r&&(t.text=r),e&&e.cardUrl&&(t.cardUrl=e.cardUrl),this._updateSingleComposer(t)}(r||e&&e.cardUrl||t.length>0||i.length>0)&&!s&&a.replace({query:Object(Gi.b)(o.query),search:"",pathname:o.pathname,state:Object(cn.a)(Object(Gi.b)(o.state||{}),["defaultText","externalMedia","externalMediaFiles"])}),l&&l(this._areComposersValid()),n||this._setActiveParentKey(),this.isInlineReply&&this._root&&(this._height=this._root.getBoundingClientRect().height)}componentDidUpdate(e,t){const{addToast:i,composerData:a,copyDataFromInlineReplyComposerToModalComposer:s,externalMedia:n,externalMediaFiles:o,onRef:r,parentTweetId:l,replyPressToggle:c,setValidity:d,windowWidth:h,getTweetHeight:u}=this.props,{textMap:p}=this.state;if(this.isInlineReply&&u&&this._root&&(e.composerData!==a||t.textMap!==p)){const e=this._root.getBoundingClientRect().height;if(e!==this._height){this._height=e;const t=e+u();this._handleHeightChanged(t)}}h!==e.windowWidth&&this._throttledSyncTexts(),e.onRef&&e.onRef!==r&&e.onRef(void 0),r&&r!==e.onRef&&r(this),a.length>=25&&e.composerData.length<25&&i({text:An}),n.length>0&&n!==e.externalMedia?this._attachExternalMedia(0)(n):o.length>0&&o!==e.externalMediaFiles&&this._handleAddMediaFiles(0)(o),d&&!Object(pn.a)(a,e.composerData)&&d&&d(this._areComposersValid()),c!==e.replyPressToggle&&s(l)}componentWillUnmount(){const{composerData:e,onRef:t}=this.props;this._unblockHistory&&this._unblockHistory(),t&&t(void 0),Object(mn.a)(this._composerRefs).forEach((([t,i])=>{const a=parseInt(t,10);if(i)return e[a]&&e[a].pollActive&&this._updateSingleComposer({initialPollChoices:i.pollChoices,initialPollDuration:i.pollDuration},a)})),this._syncTexts()}render(){const{parentTweetId:e}=this.props;return e?r.createElement(r.Fragment,null,this._render(!0),this._render()):this._render()}_scribe(e,t){const{analytics:i}=this.props;i.scribe({...e,data:t})}get isInlineReply(){const{parentTweetId:e}=this.props;return!!e}get isThread(){return this.props.composerData.length>1}get isRetweet(){const{composerData:e}=this.props,t=0===e[0].media.length,i=this._getSingleComposerDataWithLatestText(e[0]).text;return!this.isThread&&e[0].quotedStatus&&""===i&&t}get isQuoteTweet(){const{composerData:e}=this.props,t=this._getSingleComposerDataWithLatestText(e[0]).text;return!this.isThread&&e[0].quotedStatus&&t.length>0}get hasNonCompliantQuote(){var e;const{composerData:t}=this.props;return"non_compliant"===(null==(e=t[0].quotedStatus)?void 0:e.limited_actions)}get shouldShowDiscardConfirmation(){const{isSending:e,composerData:t}=this.props,{scheduledTweetId:i}=t[0],{showDiscardTweetConfirmation:a}=this.state,s=this._areComposersEmptyOrUnchanged();return!(e||s||a||i)}get shouldShowBackgroundSendConfirmation(){const{composerData:e,isSending:t}=this.props,i=e.some((e=>e.media.some((e=>e.uploading))));return t&&i}get _canSaveDraft(){const{composerData:e,isInline:t}=this.props;return!(this.isCommunityTweet||this.isThread||e[0].pollActive||0!==e[0].mediaTags.length||t)}get isCommunityTweet(){const{inReplyToStatus:e,selectedCommunityId:t}=this.props;return!!(null!=e&&e.community_id_str||t)}get isCommunityTweetFromProtectedUser(){var e;return!(!this.isCommunityTweet||null==(e=this.props.activeUser)||!e.protected)}get isReply(){return!(!this.props.inReplyToStatus&&!this.props.inReplyToStatusId)}get tweetType(){return this.isQuoteTweet?On.Quote:this.isThread?On.Thread:this.isReply?On.Reply:On.Original}get isPreview(){const{undoTweetSettings:e}=this.props;return this._canComposePreview&&("original"===this.tweetType||"reply"===this.tweetType)&&(!e||void 0===e[this.tweetType]||e[this.tweetType])}}o()(Ln,"defaultProps",{customizePropsForSingleComposerItem:(e,t,i)=>({}),externalMedia:[],externalMediaFiles:[],isSelfThreadReply:!1,isModal:!1,positionCursorAtBeginning:!1,prepopulatedText:"",setValidity:()=>{},typeaheadWrapper:Ds.a}),o()(Ln,"contextType",Nt.a),o()(Ln,"_validateMedia",((e,t)=>{const{media:i}=e;return Object(c.c)(i.concat(t))}));const Fn=A.a.create((e=>({root:{paddingBottom:e.spaces.space4},content:{paddingVertical:e.spaces.space4,backgroundColor:e.colors.cellBackground},contentModal:{borderBottomLeftRadius:e.borderRadii.xLarge,borderBottomRightRadius:e.borderRadii.xLarge},contentInlineReply:{paddingVertical:e.componentDimensions.gutterVertical},mask:{...A.a.absoluteFillObject},inlineSendButton:{marginLeft:e.spaces.space12},progressBar:{position:"absolute",borderTopLeftRadius:e.borderRadii.small,borderTopRightRadius:e.borderRadii.small},inlineCallout:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},hidden:{position:"absolute",visibility:"hidden",width:"100%"}})));t.a=Object(le.a)(Na(Ln))},VjLy:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var a=i("ERkP"),s=i("xZGM"),n=i("3XMw"),o=i.n(n),r=i("feu+"),l=i("eb3s"),c=i("lUZE"),d=i("5cUs");const h=o.a.ge5067bb,u=o.a.ea626ab3,p=o.a.fc716886,m=`${o.a.f2a2a06e}\n\n${o.a.f82c0bbf}`,g=o.a.b2615c6d,_=o.a.i62a03aa,y=o.a.cfd2f35d,b=o.a.a6450e83,f=o.a.hb279a11,C=({onConfirm:e,onCancel:t,onHideReplyImpression:i=(()=>{})})=>a.createElement(r.a,{actionLabel:h,graphic:c.a,headline:p,onAction:e,onClose:t,onImpression:i,onTertiaryAction:t,subtext:m,supportUrl:"https://help.twitter.com/en/using-twitter/mentions-and-replies?lang=browser#hidden-reply",tertiaryActionLabel:y});t.b=({addFlag:e,addToast:t,clientEventEntityToken:i,createLocalApiErrorHandler:n,hideReply:o,onBlock:r,onTweetDismiss:c,scribeAction:p,shouldShowHideReplyTip:m,tweet:y})=>{const w=()=>{p({element:"moderated_replies_prompt",action:"impression"})};return{confirmation:m?{render:(e,t)=>C({onConfirm:e,onCancel:t,onHideReplyImpression:w})}:{render:(e,t)=>{const{user:{screen_name:i}}=y;return a.createElement(l.a,{cancelButtonLabel:_,confirmButtonLabel:b,confirmButtonType:"destructive",headline:g({screenName:i}),onCancel:e,onConfirm:()=>{r(),e()},text:f({screenName:i})})}},text:h,onClick:()=>{e(s.i),o(y.id_str,{conversation_id:y.conversation_id_str}).then((e=>{c&&c(),t({text:u,clientEventEntityToken:i})}),n({showToast:!0})),p({element:"moderate_reply"})},Icon:d.a}}},WOwf:function(e,t,i){"use strict";function a(e,t){return Math.min(1,1-e/t)}i.d(t,"a",(function(){return a}))},Zg3A:function(e,t,i){"use strict";var a=i("ERkP"),s=i("Lsrn"),n=i("k/Ka");const o=(e={})=>Object(n.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[s.a.root,e.style],viewBox:"0 0 24 24"},a.createElement("g",null,a.createElement("path",{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm8.472 9.442c-.242.19-.472.368-.63.486-.68-1.265-1.002-1.78-1.256-2.007-.163-.145-.37-.223-.78-.375-.367-.136-1.482-.55-1.65-.85-.087-.153.136-.602.23-.793.088-.177.164-.33.196-.497.123-.646-.33-1.146-.728-1.59-.066-.072-.153-.17-.23-.26.335-.12.862-.26 1.42-.384 1.95 1.448 3.26 3.704 3.428 6.272zm-9.788-7.83c.076.25.145.5.182.678-.255.15-.663.363-.96.52-.262.136-.522.273-.738.392-.247.137-.442.234-.6.313-.347.174-.598.3-.833.553-.068.073-.26.278-1.02 1.886l-1.79-.656c1.293-1.94 3.362-3.31 5.76-3.685zM12 20.5c-4.687 0-8.5-3.813-8.5-8.5 0-1.197.25-2.335.7-3.37.47.182 1.713.66 2.75 1.035-.107.336-.245.854-.26 1.333-.03.855.502 1.7.562 1.792.053.08.12.15.2.207.303.21.687.5.827.616.063.343.166 1.26.23 1.833.144 1.266.175 1.48.24 1.65.005.012.514 1.188 1.315 1.188.576-.003.673-.206 1.855-2.688.244-.512.45-.95.513-1.058.1-.144.597-.61.87-.83.55-.442.76-1.82.413-2.682-.335-.83-1.92-2.08-2.5-2.195-.17-.033-.43-.04-.953-.053-.497-.01-1.25-.028-1.536-.09-.098-.024-.314-.094-.605-.196.32-.668.627-1.28.71-1.4.05-.052.168-.112.408-.234.17-.086.383-.192.653-.34.208-.116.458-.247.71-.38 1.168-.612 1.484-.8 1.658-1.082.11-.177.263-.44-.04-1.544 1.042.027 2.038.24 2.955.61-.89.32-1.024.595-1.106.77-.367.784.256 1.475.667 1.93.096.107.24.268.32.38l-.017.036c-.234.472-.67 1.35-.196 2.194.406.72 1.384 1.13 2.437 1.52.134.05.25.092.33.126.16.208.496.79 1 1.735l.154.285c.078.14.33.505.842.505.167 0 .363-.04.59-.137.032-.013.083-.035.18-.094C19.72 17.405 16.22 20.5 12 20.5zm-3.812-9.45c.01-.285.102-.646.184-.907l.027.006c.397.09 1.037.11 1.83.13.32.006.59.008.615 0 .326.143 1.355 1 1.483 1.31.113.28.05.812-.034 1.01-.233.197-.845.735-1.085 1.078-.093.13-.212.373-.64 1.274-.133.276-.313.654-.488 1.013-.026-.225-.054-.472-.08-.686-.225-2.003-.273-2.22-.42-2.445-.05-.078-.202-.31-1.135-.973-.117-.213-.268-.564-.26-.813z"})));o.metadata={width:24,height:24},t.a=o},c0ZR:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));const a=e=>new Promise(((t,i)=>{const a=new window.XMLHttpRequest;a.responseType="blob",a.onreadystatechange=()=>{a.readyState===window.XMLHttpRequest.DONE&&(200===a.status?t(a.response):i(new Error("Unexpected status code")))},a.onerror=e=>i(e),a.ontimeout=e=>i(e),a.open("GET",e,!0),a.send()}))},"p+r5":function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var a=i("97Jx"),s=i.n(a),n=i("KEM+"),o=i.n(n),r=i("ERkP"),l=i("38/B"),c=i("t62R"),d=i("piX5"),h=i("3XMw"),u=i.n(h),p=i("tI3i"),m=i.n(p),g=i("oQhu"),_=i("rHpw"),y=i("aITJ"),b=i("MWbm"),f=(i("aWzz"),i("Oib4")),C=i("WtWS"),w=i("ioan");const v=e=>e.length,T=(e,t=v)=>t(e);class x extends r.Component{constructor(e){super(e),o()(this,"_blurOnBackspaceKeyUpForKaiOS",!1),o()(this,"_isLabelLarge",(()=>{const{isFocused:e,actualCount:t}=this.state;return!t&&!e})),o()(this,"_getTextInputStyle",Object(g.a)((e=>[E.root,!e&&E.disabled]))),o()(this,"_calculateLength",(e=>T(e,this.props.calculateLength))),o()(this,"_shouldRenderDisplayCount",(()=>{const{isFocused:e}=this.state,t=this._isFormInvalid();return Boolean((e||t)&&this._getMaxDisplayCount())})),o()(this,"_isInvalidNumber",(()=>{var e,t,i,a,s;const{type:n}=this.props,o=null==(e=this._textInput)||null==(t=e.textInputNode)?void 0:t.value,r=null==(i=this._textInput)||null==(a=i.textInputNode)||null==(s=a.validity)?void 0:s.badInput;return"number"===n&&""===o&&!0===r})),o()(this,"_getActualCount",(e=>{let t=e.length;return this._isInvalidNumber()&&(t=1),t})),o()(this,"_handleBlur",(e=>{const{onBlur:t}=this.props,{value:i}=e.currentTarget,a=this._calculateLength(i),s=this._getActualCount(i);this.setState({isFocused:!1,displayCount:a,actualCount:s}),t&&t(e)})),o()(this,"_handleChange",(e=>{const{onChange:t}=this.props,{value:i}=e.currentTarget,a=this._calculateLength(i),s=this._getActualCount(i);this.setState({isFocused:!0,displayCount:a,actualCount:s}),t&&t(e)})),o()(this,"_handleFocus",(e=>{const{onFocus:t}=this.props;this.setState({isFocused:!0}),t&&t(e)})),o()(this,"_handleKeyPress",(e=>{const{multiline:t,onKeyPress:i,onSubmitEditing:a}=this.props;i&&i(e),e.isDefaultPrevented()||"Enter"!==e.key||e.shiftKey||t||!a||(e.preventDefault(),a(e))})),o()(this,"_handleKeyDown",(e=>{const{onKeyDown:t}=this.props,{displayCount:i}=this.state,a=0===i;y.b.isKaiOS()&&"Backspace"===e.key&&a?this._blurOnBackspaceKeyUpForKaiOS=a:t&&t(e)})),o()(this,"_handleKeyUp",(e=>{const{onKeyUp:t}=this.props;y.b.isKaiOS()&&"Backspace"===e.key&&this._blurOnBackspaceKeyUpForKaiOS&&(e.preventDefault(),this.blur()),t&&t(e)})),o()(this,"_setTextInputRef",(e=>{this._textInput=e})),o()(this,"_checkComponentPropsUsageCorrectness",(e=>{const{defaultValue:t,maxLength:i,validLength:a,value:s,onChange:n}=e,o=!!n,r="string"==typeof s,l="string"==typeof t;m()(!(!l&&r&&!o),"A controlled component, a component with a value prop, must have an onChange handler. The value prop cannot be undefined."),m()(!(i&&a&&a>i),"Max length should be equal or greater than valid length."),m()(!(void 0!==i&&i<=0||void 0!==a&&a<=0),"Set editable to false instead of limiting the valid character count to 0.")})),o()(this,"_exceedsValidLength",(e=>{const t=this._getMaxDisplayCount();return!!t&&e>t})),o()(this,"_getMaxDisplayCount",(()=>this.props.validLength||this.props.maxLength)),this._checkComponentPropsUsageCorrectness(e);const{defaultValue:t,value:i}=e;this.state={displayCount:this._calculateLength(i||t||""),actualCount:v(i||t||""),isFocused:!1}}componentDidUpdate(e){const{validLength:t,maxLength:i,onChange:a,value:s}=this.props,{validLength:n,maxLength:o,onChange:r,value:l}=e;n===t&&i===o&&!!a===!!r&&"string"==typeof s===("string"==typeof l)||this._checkComponentPropsUsageCorrectness(this.props)}static getDerivedStateFromProps(e,t){const{calculateLength:i,value:a}=e,s="string"==typeof a?T(a,i):0;return"string"==typeof a&&s!==t.displayCount?{displayCount:s,actualCount:a.length}:null}render(){const{accessibilityLabel:e,errorText:t,helperText:i,style:a,editable:s}=this.props,{isFocused:n}=this.state,o=this._isFormInvalid();return r.createElement(b.a,{style:[S.root,a]},r.createElement(b.a,{accessibilityLabel:e,accessibilityRole:"label",style:[d.a.border,S.textInputFormStyle,o&&d.a.invalidBorderColor,n&&o&&d.a.focusedBorderInvalid,n&&!o&&d.a.focusedBorderValid,!s&&d.a.disabled]},r.createElement(b.a,{style:S.textInputFormWrapper},r.createElement(b.a,{style:[S.textInputHeader]},this._renderLabel(),this._shouldRenderDisplayCount()?this._renderDisplayCount():null),this._renderTextInput())),r.createElement(b.a,{style:[S.sidePadding,S.underTextInputForm]},r.createElement(b.a,{style:S.subtextWrapper},i?this._renderHelperText():null,o&&t?this._renderErrorText():null)))}_renderLabel(){const{label:e}=this.props,{isFocused:t}=this.state,i=t?"primary":"gray700",a=this._isFormInvalid()?"red500":i,s=this._isLabelLarge();return r.createElement(c.c,{color:s?"gray700":a,numberOfLines:1,size:s?"headline1":"subtext2",style:[S.textInputHeaderItem,s&&S.placeholderText,!l.a.reducedMotionEnabled&&S.transition]},e)}_renderTextInput(){const{accessibilityLabel:e,calculateLength:t,editable:i,errorText:a,helperText:n,Icon:o,invalid:l,label:d,maxLength:h,onBlur:u,onChange:p,onSubmitEditing:m,onFocus:g,onKeyDown:_,onKeyPress:y,onKeyUp:f,showValidationIcon:C,style:v,validLength:T,...x}=this.props,S=this.getValue(),I=this._calculateLength(S),R=h?h+S.length-I:void 0;return r.createElement(b.a,{style:E.container},o&&!this._isLabelLarge()?this._renderIcon():null,r.createElement(c.c,{size:"headline1",style:E.wrapper},r.createElement(w.a,s()({},x,{editable:i,maxLength:R,onBlur:this._handleBlur,onChange:this._handleChange,onFocus:this._handleFocus,onKeyDown:this._handleKeyDown,onKeyPress:this._handleKeyPress,onKeyUp:this._handleKeyUp,ref:this._setTextInputRef,style:this._getTextInputStyle(i)}))),C&&!this._isLabelLarge()?this._renderValidationIcon():null)}_renderHelperText(){return r.createElement(b.a,{accessibilityLiveRegion:"polite"},r.createElement(c.c,{color:"gray700",size:"subtext2",style:S.subtext},this.props.helperText))}_renderErrorText(){return r.createElement(b.a,{accessibilityLiveRegion:"assertive"},r.createElement(c.c,{color:"red500",size:"subtext2",style:S.subtext},this.props.errorText))}_renderDisplayCount(){const{displayCount:e}=this.state,t=this._getMaxDisplayCount(),i=this._exceedsValidLength(e),a=t&&u.a.ia24dc8c(t),s=u.a.ia24dc8c(e);return r.createElement(b.a,{accessibilityLiveRegion:"polite",style:[S.textInputHeaderItem,S.displayCount]},r.createElement(c.c,{color:i?"red500":"gray700",size:"subtext2"},a?`${s} / ${a}`:""))}_renderIcon(){const{Icon:e}=this.props,{isFocused:t}=this.state,i=[S.icon,t&&S.focusedIcon];return e&&r.createElement(e,{style:i})}_renderValidationIcon(){return this._isFormInvalid()?r.createElement(f.a,{style:[S.validationIcon,d.a.invalidColor]}):r.createElement(C.a,{style:[S.validationIcon,d.a.validColor]})}_isFormInvalid(){const{displayCount:e}=this.state;return this.props.invalid||this._exceedsValidLength(e)||this._isInvalidNumber()}blur(){this._textInput&&this._textInput.blur()}getValue(){return this._textInput&&this._textInput.getValue()||""}focus(){this._textInput&&this._textInput.focus()}isValidLength(){const e=this.getValue(),t=this._calculateLength(e);return!this._exceedsValidLength(t)}}o()(x,"defaultProps",{autoComplete:"on",autoCorrect:!0,autoFocus:!1,editable:!0,invalid:!1}),x.propTypes={};const E=_.a.create((e=>({container:{flexDirection:"row",flexGrow:1,flexShrink:1,overflow:"hidden",paddingBottom:e.spaces.space8,paddingHorizontal:e.spaces.space8,paddingTop:e.spaces.space12,marginTop:e.spaces.space16},root:{backgroundColor:"transparent",borderRadius:e.borderRadii.none,borderWidth:e.borderWidths.none,boxSizing:"border-box",color:"inherit",fontFamily:"inherit",fontSize:"inherit",textAlign:"inherit",outlineStyle:"none",padding:0},wrapper:{alignItems:"center",display:"flex",fontSize:e.fontSizes.headline2,width:"100%"},disabled:{color:e.colors.gray700}}))),S=_.a.create((e=>({root:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},textInputFormStyle:{flexDirection:"row"},textInputFormWrapper:{flexGrow:1,flexShrink:1},textInputHeader:{flexDirection:"row",justifyContent:"space-between",position:"absolute",height:"100%",width:"100%"},textInputHeaderItem:{paddingTop:e.spaces.space8,paddingHorizontal:e.spaces.space8,fontSize:"small"},placeholderText:{paddingTop:e.spaces.space16,fontSize:e.fontSizes.headline2,userSelect:"none"},displayCount:{flexGrow:1,alignItems:"flex-end"},sidePadding:{paddingHorizontal:e.spaces.space8},underTextInputForm:{flexDirection:"row"},subtextWrapper:{flexDirection:"column",flex:1,paddingRight:e.spaces.space20,paddingTop:e.spaces.space2},subtext:{alignSelf:"flex-start"},focusedIcon:{color:e.colors.primary},icon:{alignSelf:"center",color:e.colors.gray700,paddingRight:e.spaces.space4},validationIcon:{alignSelf:"center",paddingLeft:e.spaces.space4},transition:{transition:"transform 150ms cubic-bezier(0.4, 0, 0.2, 1), color 150ms cubic-bezier(0.4, 0, 0.2, 1), font-size 150ms cubic-bezier(0.4, 0, 0.2, 1), padding-top 150ms cubic-bezier(0.4, 0, 0.2, 1)"}})))},piX5:function(e,t,i){"use strict";const a=i("rHpw").a.create((e=>({border:{borderRadius:e.borderRadii.small,borderWidth:e.borderWidths.small,borderColor:e.colors.gray200},focusedBorderValid:{boxShadow:`0 0 0 ${e.borderWidths.small} ${e.colors.primary}`,borderColor:e.colors.primary},focusedBorderInvalid:{boxShadow:`0 0 0 ${e.borderWidths.small} ${e.colors.red500}`},invalidBorderColor:{borderColor:e.colors.red500},invalidColor:{color:e.colors.red500},validColor:{color:e.colors.primary},disabled:{cursor:"default",opacity:.5,backgroundColor:e.colors.gray50,borderColor:e.colors.gray50}})));t.a=a},pidX:function(e,t,i){"use strict";i.d(t,"b",(function(){return l}));i("kYxP");var a=i("3XMw"),s=i.n(a),n=i("3A2y");const o=s.a.b2e94283,r=["title","screen_name","text","url","hashtags","via"];t.a=e=>{const t=e.state||{},i=e.query||{},[a,s,n,l,c,d]=r.map((e=>t[e]||i[e])),h=[a,s&&`@${s.toString()}`,n,l,c&&c.toString().split(",").map((e=>`#${e}`)).join(" "),d&&o({viaScreenName:d})].filter(Boolean).join(" ");return h?`${h} `:void 0};const l=e=>Object(n.a)(e,r)},rziq:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s}));const a="send-tweet",s="dismiss-composer"},sCk0:function(e,t,i){"use strict";var a=i("KEM+"),s=i.n(a),n=(i("kYxP"),i("ERkP")),o=i("zfvc"),r=i("zrc3");const l=Object.freeze({in:"in",out:"out",static:"static"});class c extends n.Component{constructor(...e){super(...e),s()(this,"state",{isAnimating:!1,renderChildren:n.Children.toArray(this.props.children).map((e=>({status:l.static,child:e})))}),s()(this,"_handleEachAnimateComplete",(()=>{const{isAnimating:e}=this.state,{onAnimateComplete:t,children:i}=this.props;e&&(t&&t(),this.setState({renderChildren:n.Children.toArray(i).map((e=>({status:l.static,child:e}))),isAnimating:!1}))}))}static getDerivedStateFromProps(e,t){const i=((e,t)=>{let i=0,a=0;const s=[];for(;a<e.length;){if(i>=t.length){s.push(...e.slice(a).map((e=>({child:e,status:l.out}))));break}const n=t[i],o=e[a];if(n.key===o.key)s.push({child:n,status:l.static}),i+=1;else{const e=Object(r.a)(t,(e=>e.key===o.key));e>=0?(s.push(...t.slice(i,e).map((e=>({child:e,status:l.in}))),{child:t[e],status:l.static}),i=e+1):s.push({child:o,status:l.out})}a+=1}return i<t.length&&s.push(...t.slice(i).map((e=>({child:e,status:l.in})))),s})(t.renderChildren.map((e=>e.child)),n.Children.toArray(e.children));return{renderChildren:i,isAnimating:!i.every((e=>e.status===l.static))}}render(){const{renderChildren:e}=this.state;return e.map((({status:e,child:t})=>n.createElement(o.a,{animateMount:e!==l.static,key:t.key,onAnimateComplete:this._handleEachAnimateComplete,show:e!==l.out},t)))}}t.a=c},yTN1:function(e,t,i){"use strict";var a=i("ERkP"),s=i("WOwf"),n=i("3XMw"),o=i.n(n),r=i("k6Ei"),l=i("rHpw"),c=i("+/1j"),d=i("MWbm");const h=o.a.c2fc878c,u=o.a.db11b27f,p=e=>e,m=l.a.create((({colors:e})=>({root:{alignItems:"flex-start",minHeight:30,minWidth:30},center:{alignItems:"center",justifyContent:"center",margin:"auto"},progressCircle:{transitionDuration:"0.2s",transitionProperty:"opacity"},hide:{opacity:0},text:{fontSize:13,lineHeight:.8,minWidth:16,textAlign:"center"},gray700:{color:e.gray700},red500:{color:e.red500}})));t.a=e=>{const{count:t,maxCount:i,formatNumber:n=p,warningCount:o}=e,g=i-t,_=g>=0?u({count:n(g)}):h({count:n(t-i)}),y=t>=o?a.createElement(c.a,{accessibilityAtomic:!0,accessibilityLiveRegion:"polite",style:l.a.visuallyHidden},_):null,b=Object(s.a)(g,i),f=t>=i?"red500":t>=o?"yellow500":"primary",C=a.createElement(r.a,{color:f,progress:b,size:t>=o?30:20,style:[m.progressCircle,g<=-10&&m.hide]}),w=t>=o?a.createElement(c.a,{style:[m.text,g>0?m.gray700:m.red500]},n(g)):null;return a.createElement(d.a,{style:[m.root,m.center]},y,C,a.createElement(d.a,{style:[l.a.absoluteFill,m.center]},w))}},yZqq:function(e,t,i){"use strict";var a=i("97Jx"),s=i.n(a),n=(i("kYxP"),i("ERkP")),o=i("H7Rt"),r=i("3XMw"),l=i.n(r),c=i("MWbm"),d=i("t62R"),h=i("CKsB"),u=i("/yvb"),p=i("rHpw"),m=i("Zg3A"),g=i("Lsrn"),_=i("k/Ka");const y=(e={})=>Object(_.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[g.a.root,e.style],viewBox:"0 0 24 24"},n.createElement("g",null,n.createElement("path",{d:"M10.43 12.24c-1.37 0-2.89-.15-3.87-1.26-.82-.95-1.09-2.39-.81-4.43C6.13 3.7 7.88 2 10.43 2s4.3 1.7 4.68 4.55c.27 2.04.01 3.49-.81 4.42-.98 1.12-2.51 1.27-3.87 1.27zm0-8.73c-2.39 0-3.03 2.03-3.19 3.24-.21 1.56-.06 2.65.45 3.23.46.53 1.28.75 2.73.75 1.46 0 2.28-.22 2.74-.75.51-.58.66-1.67.45-3.23-.16-1.21-.79-3.24-3.18-3.24zm2.01 18.99H4.22c-.7 0-1.33-.3-1.75-.83-.43-.54-.57-1.26-.4-1.95.88-3.55 4.31-6.03 8.34-6.03.42 0 .75.34.75.75 0 .42-.34.75-.75.75-3.34 0-6.17 2.01-6.88 4.89-.06.25-.02.49.12.66.13.16.32.25.56.25h8.22c.42 0 .75.34.75.75.01.42-.32.76-.74.76zm9.15-10.87l-4.2 8.46c-.01.03-.02.05-.04.07-.02.06-.06.11-.1.15-.05.05-.1.09-.15.13h-.01c-.06.04-.12.06-.19.08-.07.02-.13.03-.2.03-.05 0-.11 0-.17-.02-.06-.01-.11-.03-.16-.06-.06-.03-.12-.07-.18-.12-.01-.01-.03-.02-.04-.03l-3.08-3.27c-.28-.3-.27-.78.04-1.06.3-.29.77-.27 1.06.03l2.34 2.48 3.74-7.53c.18-.37.63-.52 1-.34.37.17.52.63.34 1z"}),n.createElement("path",{d:"M17.1 20.44c.05-.04.1-.08.15-.13 0 .01-.02.03-.03.04-.04.04-.08.06-.12.09z"})));y.metadata={width:24,height:24};var b=y,f=i("boUI"),C=i("EweD");const w=l.a.g6185a9e,v=l.a.g2d04222,T=l.a.baffe39a,x=l.a.af293dc2,E=l.a.h1053f7e,S=l.a.bf994ab2,I=l.a.cf7f7e39,R=l.a.cfd2f35d,A=p.a.create((e=>({root:{flexDirection:"column",paddingTop:e.spaces.space16,paddingBottom:e.spaces.space4,borderRadius:e.borderRadii.xLarge},popover:{maxWidth:5*e.spacesPx.space64},modal:{borderRadius:e.borderRadii.none},title:{flexDirection:"column",paddingHorizontal:e.spaces.space16,marginBottom:e.spaces.space12},menuRow:{flexDirection:"row",paddingTop:e.spaces.space12,paddingBottom:e.spaces.space12,alignItems:"center",borderRadius:e.borderRadii.small},cancelButton:{marginHorizontal:e.spaces.space16,marginVertical:e.spaces.space16}})));var k=e=>{var t,i;const{dismiss:a,isModal:s,value:r,midConversationTweet:l}=e,p=t=>()=>{e.onChange(t),e.dismiss()},g=!!l,_=g&&!(null!=l&&null!=(t=l.entities)&&null!=(i=t.user_mentions)&&i.some((e=>e.id_str!==l.user.id_str)));let y=E;return _?y=S:g&&(y=I),n.createElement(c.a,{accessibilityDescribedBy:"conversation-controls-details",accessibilityLabelledBy:"conversation-controls-title",accessibilityRole:"dialog",style:[A.root,s?A.modal:A.popover]},n.createElement(c.a,{style:A.title},n.createElement(d.c,{nativeID:"conversation-controls-title",weight:"bold"},w),n.createElement(d.c,{color:"gray700",nativeID:"conversation-controls-details",size:"body"},v)),n.createElement(c.a,null,n.createElement(h.a,{Icon:m.a,actionText:T,isSelected:o.a.all===r,onClick:p(o.a.all),selectable:!0,style:A.menuRow,withIconAsThumbnail:!0}),n.createElement(h.a,{Icon:b,actionText:x,isSelected:o.a.community===r,onClick:p(o.a.community),selectable:!0,style:A.menuRow,withIconAsThumbnail:!0}),n.createElement(h.a,{Icon:_?f.a:C.a,actionText:y,isSelected:o.a.by_invitation===r,onClick:p(o.a.by_invitation),selectable:!0,style:A.menuRow,withIconAsThumbnail:!0}),e.isModal?n.createElement(u.a,{key:"button_cancel",onPress:a,size:"experimentalLarge",style:A.cancelButton,type:"neutral"},R):null))},M=i("OiMc"),B=i("efqG");t.a=e=>{const{children:t,disabled:i,controlled:a=!1}=e,[o,r]=n.useState(!1),l=n.useCallback((()=>r(!0)),[]),c=n.useCallback((()=>r(!1)),[]),d=a?o?M.a.VISIBILITY_BEHAVIOR.forceVisible:M.a.VISIBILITY_BEHAVIOR.forceHidden:void 0,h="function"==typeof t?t({openPopover:l,closePopover:c}):t;return n.createElement(B.a,{disabled:i,onDismiss:c,renderContent:(t,i)=>{const{children:a,controlled:o,...r}=e;return n.createElement(k,s()({},r,{dismiss:t,isModal:"sheet"===i}))},visibilityBehavior:d},h)}},zmS9:function(e,t,i){"use strict";var a=i("ERkP"),s=i("3XMw"),n=i.n(s),o=i("J0mu"),r=i("t62R"),l=i("rHpw"),c=i("QbaN");const d=n.a.bfb895b1,h=l.a.create((e=>({icon:{fontSize:e.fontSizes.body,paddingRight:e.spaces.space12,textAlignVertical:"middle"}})));t.a=({scheduledFor:e,onPress:t})=>{const i=Object(c.c)(e),s=!!i&&(Object(c.h)(e)&&!Object(c.g)(i)&&!Object(c.f)(i)),n=Boolean(t);return i&&s?a.createElement(r.c,{color:"gray700",onPress:t,size:"subtext2",withInteractiveStyling:n},a.createElement(o.a,{style:h.icon}),d({date:Object(c.b)(i),time:Object(c.i)(i)})):null}}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~bundle.Compose~bundle.RichTextCompose~bundle.PlainTextCompose.86140355.js.map